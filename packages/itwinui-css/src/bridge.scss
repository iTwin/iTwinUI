// Copyright (c) Bentley Systems, Incorporated. All rights reserved.
// See LICENSE.md in the project root for license terms and full copyright notice.

.iui-root:where([data-iui-bridge='true']) {
  --iui-color-white: var(--stratakit-color-static-white);

  --iui-color-background: var(--stratakit-color-bg-page-base);
  --iui-color-background-disabled: var(--stratakit-color-bg-glow-on-surface-disabled);
  --iui-color-background-zebra: var(--iui-color-background); /* TODO: Use proper value when added */
  --iui-color-background-hover: var(--iui-color-background);
  --iui-color-background-backdrop: var(--stratakit-color-bg-page-base);
  --iui-color-background-backdrop-hover: var(--iui-color-background-backdrop);
  --iui-color-background-accent: var(--stratakit-color-bg-accent-base);
  --iui-color-background-accent-hover: var(--iui-color-background-accent);
  --iui-color-background-accent-muted: var(--stratakit-color-bg-glow-on-surface-accent-pressed);

  --iui-color-border-foreground: var(--stratakit-color-border-mono-muted);
  --iui-color-border-foreground-hover: var(--iui-color-border-foreground);

  --iui-color-background-informational: var(--stratakit-color-bg-info-base);
  --iui-color-background-informational-hover: var(--iui-color-background-informational);
  --iui-color-background-informational-muted: var(--stratakit-color-bg-info-muted);
  --iui-color-background-positive: var(--stratakit-color-bg-positive-base);
  --iui-color-background-positive-hover: var(--iui-color-background-positive);
  --iui-color-background-positive-muted: var(--stratakit-color-bg-positive-muted);
  --iui-color-background-warning: var(--stratakit-color-bg-attention-base);
  --iui-color-background-warning-hover: var(--iui-color-background-warning);
  --iui-color-background-warning-muted: var(--stratakit-color-bg-attention-muted);
  --iui-color-background-negative: var(--stratakit-color-bg-critical-base);
  --iui-color-background-negative-hover: var(--iui-color-background-negative);
  --iui-color-background-negative-muted: var(--stratakit-color-bg-critical-muted);

  --iui-color-border-informational: var(--stratakit-color-border-info-faded);
  --iui-color-border-positive: var(--stratakit-color-border-positive-faded);
  --iui-color-border-warning: var(--stratakit-color-border-attention-faded);
  --iui-color-border-negative: var(--stratakit-color-border-critical-faded);

  --iui-color-border: var(--stratakit-color-border-neutral-base);
  --iui-color-border-hover: var(--iui-color-border);
  --iui-color-border-disabled: var(--stratakit-color-border-glow-on-surface-disabled);
  --iui-color-border-subtle: var(--stratakit-color-border-neutral-muted);
  --iui-color-border-accent: var(--stratakit-color-border-accent-strong);

  --iui-color-icon-accent: var(--stratakit-color-icon-accent-strong);
  --iui-color-icon-informational: var(--stratakit-color-icon-info-faded);
  --iui-color-icon-positive: var(--stratakit-color-icon-positive-faded);
  --iui-color-icon-warning: var(--stratakit-color-icon-attention-faded);
  --iui-color-icon-negative: var(--stratakit-color-icon-critical-faded);

  --iui-color-icon: var(--stratakit-color-icon-neutral-base);
  --iui-color-icon-hover: var(--iui-color-icon);
  --iui-color-icon-muted: var(--stratakit-color-icon-neutral-secondary);
  --iui-color-icon-muted-hover: var(--iui-color-icon-muted);
  --iui-color-icon-disabled: var(--stratakit-color-icon-neutral-disabled);
  --iui-color-icon-disabled-hover: var(--iui-color-icon-disabled);

  --iui-color-text-informational: var(--stratakit-color-text-info-faded);
  --iui-color-text-positive: var(--stratakit-color-text-positive-faded);
  --iui-color-text-warning: var(--stratakit-color-text-attention-faded);
  --iui-color-text-negative: var(--stratakit-color-text-critical-faded);

  --iui-color-text-informational-hover: var(--iui-color-text-informational);
  --iui-color-text-positive-hover: var(--iui-color-text-positive);
  --iui-color-text-warning-hover: var(--iui-color-text-warning);
  --iui-color-text-negative-hover: var(--iui-color-text-negative);

  --iui-color-text: var(--stratakit-color-text-neutral-primary);
  --iui-color-text-hover: var(--iui-color-text);
  --iui-color-text-accent: var(--stratakit-color-text-accent-strong);
  --iui-color-text-accent-hover: var(--iui-color-text-accent);
  --iui-color-text-muted: var(--stratakit-color-text-neutral-secondary);
  --iui-color-text-disabled: var(--stratakit-color-text-neutral-disabled);
  --iui-color-text-disabled-hover: var(--iui-color-text-disabled);
  --iui-color-text-placeholder: var(--stratakit-color-text-neutral-secondary);

  &[data-iui-theme='light'] {
    --iui-color-background-hsl: 209.2deg 40.21% 98.84%; // --stratakit-color-bg-page-base
    --iui-color-foreground-hsl: 222.69deg 6.43% 12.92%; // --stratakit-color-text-neutral-primary
    --iui-color-accent-hsl: 164.5deg 68.46% 30.05%; // --stratakit-color-icon-accent-strong
    --iui-color-informational-hsl: 210.23deg 96.74% 36.73%; // --stratakit-color-icon-info-faded
    --iui-color-positive-hsl: 105.38deg 97.33% 21.67%; // --stratakit-color-icon-positive-faded
    --iui-color-warning-hsl: 39.78deg 94.44% 25.8%; // --stratakit-color-icon-attention-faded
    --iui-color-negative-hsl: 348.19deg 79.28% 40.72%; // --stratakit-color-icon-critical-faded
  }

  &[data-iui-theme='dark'] {
    --iui-color-background-hsl: 222.69deg 6.43% 12.92%; // --stratakit-color-bg-page-base
    --iui-color-foreground-hsl: 209.2deg 40.21% 98.84%; // --stratakit-color-text-neutral-primary
    --iui-color-accent-hsl: 166.21deg 96.14% 50.19%; // --stratakit-color-icon-accent-strong
    --iui-color-informational-hsl: 210.52deg 76.91% 71.38%; // --stratakit-color-icon-info-faded
    --iui-color-positive-hsl: 105.91deg 34.34% 61.19%; // --stratakit-color-icon-positive-faded
    --iui-color-warning-hsl: 40.01deg 57.6% 59.24%; // --stratakit-color-icon-attention-faded
    --iui-color-negative-hsl: 347.86deg 75.06% 76.69%; // --stratakit-color-icon-critical-faded
  }

  /* ---------------------------------------------------------------------------- */
  /* Alert */

  .iui-alert {
    // StrataKit Banner background is not --iui-color-background's global mapping
    background-color: var(--stratakit-color-bg-elevation-base);
  }

  /* ---------------------------------------------------------------------------- */
  /* Anchor */

  .iui-anchor {
    // TODO: Potentially, use underline prop.
    text-decoration: underline;

    &:where(:hover) {
      text-decoration-color: transparent;
    }

    // Neutral color instead of accent
    &:where(:not([data-iui-status])) {
      color: var(--stratakit-color-text-neutral-primary);
    }
  }

  /* ---------------------------------------------------------------------------- */
  /* Avatar */

  // StrataKit Avatar background and text colors are different from iTwinUI's global mappings.
  .iui-avatar-count {
    background-color: var(--stratakit-color-bg-mono-base);
    color: var(--stratakit-color-text-neutral-emphasis);
  }

  /* ---------------------------------------------------------------------------- */
  /* Breadcrumbs */

  .iui-breadcrumbs {
    .iui-breadcrumbs-content {
      // Manually add underline for any non iui-anchor links (since we don't have underline prop)
      &:where(:any-link) {
        text-decoration: underline;

        &:where(:hover) {
          text-decoration-color: transparent;
        }
      }
    }

    // Bring back iTwinUI accent styling for non-current breadcrumbs
    .iui-breadcrumbs-content:is(button, a):not([aria-current]) {
      color: var(--iui-color-text-accent);
    }
  }

  /* ---------------------------------------------------------------------------- */
  /* Button */

  .iui-button {
    // StrataKit button background color is not iTwinUI's --iui-color-background global mapping
    &:where(:not([data-iui-variant])):not(.iui-sidenav-button) {
      --_iui-field-color-background: var(--stratakit-color-bg-neutral-base);
      --_iui-field-color-background-hover: var(--_iui-field-color-background);
    }

    // This is needed because for CTA buttons, border-hover variables are set to bg variables
    --_iui-field-color-border-hover: var(--_iui-field-color-border);

    // Disabled buttons in StrataKit do not have a visible border
    --_iui-field-color-border-disabled: transparent;

    // CTA variant should use the same colors as high-visibility instead of using "positive" colors
    &:where([data-iui-variant='high-visibility'], [data-iui-variant='cta']) {
      --_iui-field-color-background: var(--stratakit-color-bg-accent-base);
      --_iui-field-color-background-hover: var(--_iui-field-color-background);
      --_iui-field-color-icon: var(--stratakit-color-icon-neutral-emphasis);

      // Extra visible border in StrataKit
      --_iui-field-color-border: var(--stratakit-color-border-accent-base);
    }
  }

  // For button-group, add back borders that we removed above
  .iui-button-group .iui-button:not([data-iui-variant='borderless']) {
    --_iui-field-color-border-disabled: var(--iui-color-border-disabled);
  }

  /* ---------------------------------------------------------------------------- */
  /* Checkbox/Radio */

  :is(.iui-checkbox, .iui-radio) {
    --_iui-checkbox-unchecked-svg: url('data:image/svg+xml;utf8,<svg viewBox="0 0 16 16"></svg>');
    --_iui-checkbox-checkmark-svg: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M11.2 5.6 6.8 10l-2-2"/></svg>');
    --_iui-checkbox-indeterminate-svg: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M5 8h6.5"/></svg>');

    &:not(.iui-checkbox-visibility) {
      &:not(:disabled) {
        // Check mark is plain color and not accent
        --_iui-checkbox-svg-color: var(--stratakit-color-icon-neutral-emphasis);
        // Override surface bg color with bg for interactive elements
        --_iui-checkbox-background-color: var(--stratakit-color-bg-neutral-base);

        &:checked {
          // Checked checkbox is filled and not hollow
          --_iui-checkbox-background-color: var(--stratakit-color-bg-accent-base);
          // Border is accent color
          --_iui-checkbox-border-color: var(--stratakit-color-border-accent-base);
        }
      }

      &:disabled {
        // No border when disabled
        --_iui-checkbox-border-color: transparent;
      }
    }

    &.iui-checkbox-visibility {
      /* TODO: What to do about indeterminate? */
      --_iui-checkbox-unchecked-svg: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M1.961 6.807a.5.5 0 0 0-.922.386L1.5 7l-.461.193v.002l.002.004.006.013a3.404 3.404 0 0 0 .094.202A9.478 9.478 0 0 0 2.923 9.87l-1.277 1.277a.5.5 0 1 0 .708.707l1.326-1.326a7.13 7.13 0 0 0 2.174 1.145l-.801 1.603a.5.5 0 1 0 .894.448l.907-1.814a7.253 7.253 0 0 0 2.292 0l.907 1.814a.5.5 0 1 0 .894-.448l-.801-1.603a7.13 7.13 0 0 0 2.174-1.145l1.326 1.326a.5.5 0 0 0 .708-.707L13.077 9.87a9.479 9.479 0 0 0 1.782-2.456 5.53 5.53 0 0 0 .074-.158l.02-.044.006-.013.001-.004.001-.001L14.5 7l.461.193a.5.5 0 0 0-.922-.386l-.003.007-.014.03a7.227 7.227 0 0 1-.319.605c-.234.4-.593.93-1.086 1.46C11.63 9.968 10.13 11 8 11S4.369 9.968 3.383 8.91A8.478 8.478 0 0 1 2.04 6.972a4.479 4.479 0 0 1-.075-.16l-.003-.006Z"/></svg>');
      --_iui-checkbox-checkmark-svg: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M2.14 7.849C2.736 6.774 4.616 4 8 4c3.383 0 5.263 2.774 5.86 3.849a.304.304 0 0 1 0 .302C13.264 9.226 11.384 12 8 12c-3.383 0-5.263-2.774-5.86-3.849a.304.304 0 0 1 0-.302ZM8 3C4.023 3 1.887 6.244 1.265 7.363a1.304 1.304 0 0 0 0 1.274C1.887 9.756 4.023 13 8 13c3.977 0 6.113-3.244 6.735-4.363a1.304 1.304 0 0 0 0-1.274C14.113 6.244 11.977 3 8 3ZM7 8a1 1 0 1 1 2 0 1 1 0 0 1-2 0Zm1-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4Z"/></svg>');
    }
  }

  .iui-checkbox-wrapper {
    &:not(:where([data-iui-status])):not([data-iui-disabled='true']) {
      // StrataKit labels are slightly muted
      color: var(--stratakit-color-text-neutral-secondary);
    }
  }

  /* ---------------------------------------------------------------------------- */
  /* ComboBox */

  // To match StrataKit Select instead of StrataKit Input
  .iui-field:where([role='combobox']) {
    --_iui-field-color-background: var(--stratakit-color-bg-neutral-base);
    --_iui-field-color-background-hover: var(--_iui-field-color-background);
  }

  /* ---------------------------------------------------------------------------- */
  /* Dialog/Modal */

  .iui-dialog {
    // StrataKit Dialog background color is not iTwinUI's --iui-color-background global mapping
    background-color: var(--stratakit-color-bg-elevation-base);
  }

  /* ---------------------------------------------------------------------------- */
  /* DropdownMenu/Menu */

  .iui-menu {
    // StrataKit uses different surface colors for the dropdowns
    background-color: var(--stratakit-color-bg-elevation-level-1);

    // StrataKit uses box shadow only
    border: none;
    box-shadow: var(--stratakit-shadow-surface-xl);
  }

  .iui-list-item {
    // Disabling hover to keep the code simple
    --_iui-list-item-background-hover: transparent;
  }

  /* ---------------------------------------------------------------------------- */
  /* ExpandableBlock */

  // Caption color should stay muted when hovering since trigger background color also doesn't change on hover
  .iui-expandable-header:where(:not([data-iui-disabled='true'])):where(:hover) {
    --_iui-expandable-block-header-caption-color-hover: var(--iui-color-text-muted);
  }

  /* ---------------------------------------------------------------------------- */
  /* FileUpload */

  .iui-file-upload.iui-drag > .iui-content {
    // To give anchor text the accent color since StrataKit anchors are regular color.
    .iui-anchor {
      color: var(--iui-color-text-accent);
    }
  }

  /* ---------------------------------------------------------------------------- */
  /* Footer */

  .iui-legal-footer-item {
    // StrataKit anchors colors are not muted
    a {
      color: var(--iui-color-text-muted);
    }
  }

  /* ---------------------------------------------------------------------------- */
  /* Input */

  .iui-input:where(:not([role='combobox'])) {
    // StrataKit input background colors are different from global values
    --_iui-field-color-background: var(--stratakit-color-bg-control-textbox);
    --_iui-field-color-background-hover: var(--_iui-field-color-background);
    --_iui-field-color-background-disabled: var(--_iui-field-color-background);
  }

  .iui-input-flex-container {
    // StrataKit input background colors are different from global values
    background-color: var(--stratakit-color-bg-control-textbox);
  }

  .iui-input-flex-container:where([data-iui-disabled='true']) {
    // StrataKit disabled inputs don't have a different background color
    --_iui-input-background-color: var(--iui-color-background);
  }

  /* ---------------------------------------------------------------------------- */
  /* Label */

  // StrataKit labels are slightly muted
  .iui-input-label:where(:not([data-iui-disabled='true'])) {
    --_iui-input-label-color: var(--stratakit-color-text-neutral-secondary);
  }

  /* ---------------------------------------------------------------------------- */
  /* Popover */

  .iui-popover-surface {
    // StrataKit background color is different from global values
    background-color: var(--stratakit-color-bg-elevation-level-1);
  }

  /* ---------------------------------------------------------------------------- */
  /* ProgressLinear, ProgressRadial */

  // StrataKit progress indicators's default color is not accent
  :is(.iui-progress-indicator-linear, .iui-progress-indicator-radial) {
    --_iui-progress-indicator-color-default-progress: var(--stratakit-color-icon-neutral-base);
  }

  /* ---------------------------------------------------------------------------- */
  /* Slider */
  /* TODO: Since StrataKit Slider tokens are not added, revisit this when those tokens are added on the StrataKit end */

  // Track color is not --iui-color-border-accent's global mapping
  .iui-slider {
    --_iui-slider-track-color: var(--stratakit-color-bg-accent-base);
  }

  // Background and border is not iui-color-background and iui-color-border-foreground respectively
  .iui-slider-thumb {
    background-color: var(--stratakit-color-bg-neutral-inverse);
    border-color: var(--stratakit-color-border-neutral-faded);
  }

  /* ---------------------------------------------------------------------------- */
  /* Surface */

  .iui-surface {
    // To match the surface similar to StrataKit's dropdown menu
    background-color: var(--stratakit-color-bg-elevation-base);
  }

  /* ---------------------------------------------------------------------------- */
  /* Tabs */

  .iui-tabs-wrapper {
    // The old accent stripe is now the regular stripe
    --_iui-tab-color-stripe-blue: var(--stratakit-color-border-neutral-inverse);
    // The old positive stripe is now the accent stripe
    --_iui-tab-color-stripe-green: var(--stratakit-color-border-accent-strong);

    // StrataKit has muted color on its non selected tabs
    --_iui-tab-color-default: var(--stratakit-color-text-neutral-tertiary);
    // StrataKit has no accent color on its selected tabs
    --_iui-tab-color-selected: var(--stratakit-color-text-neutral-primary);
    // The old positive color is now the accent color
    --_iui-tab-color-green-selected: var(--stratakit-color-text-accent-strong);

    // Selected tab has stripe on the bottom instead of top
    &.iui-horizontal .iui-tab::after {
      inset-inline: 4px;
      inline-size: calc(100% - 4px * 2);
      inset-block-start: calc(100% - var(--iui-size-3xs));
    }

    // Selected tab has stripe on the right instead of left
    &.iui-vertical .iui-tab::after {
      inset-block: 4px;
      block-size: calc(100% - 4px * 2);
      inset-inline-start: calc(100% - var(--iui-size-3xs));
    }
  }

  .iui-tab {
    // To account for outline-offset
    border-radius: calc(4px + 6px);

    // StrataKit tab has no border
    border: none;
  }

  .iui-tabs-content {
    // StrataKit tabs content has no background or border
    background-color: transparent;
    border: none;
    // StrataKit border color here is not equal to --iui-color-border's global mapping
    border-color: var(--stratakit-color-border-neutral-muted);
  }

  /* ---------------------------------------------------------------------------- */
  /* Tag */

  .iui-tag {
    // StrataKit tag background color is not iTwinUI's --iui-color-background global mapping
    background-color: var(--stratakit-color-bg-neutral-base);
  }

  /* ---------------------------------------------------------------------------- */
  /* Tile */

  // Background not --iui-color-background's global mapping
  :is(.iui-tile, .iui-tile-thumbnail) {
    background-color: var(--stratakit-color-bg-elevation-base);
  }

  // To make buttons match Tile background color
  .iui-tile-buttons button {
    background-color: var(--stratakit-color-bg-elevation-base);
  }

  /* ---------------------------------------------------------------------------- */
  /* ToggleSwitch */

  .iui-toggle-switch {
    &:where(:checked:not(:disabled)) {
      // Checked toggle switches need accent border
      border-color: var(--stratakit-color-border-accent-base);
    }

    &:disabled {
      // Disabled and non-disabled switches have the same background color
      background-color: var(--stratakit-color-bg-page-base);
    }
  }

  .iui-toggle-switch-wrapper {
    // StrataKit labels are slightly muted
    &:not(.iui-disabled) {
      color: var(--stratakit-color-text-neutral-secondary);
    }
  }

  /* ---------------------------------------------------------------------------- */
  /* Tooltip */

  .iui-tooltip {
    // Background and border colors are opaque
    background-color: var(--stratakit-color-bg-elevation-emphasis);
    border-color: var(--stratakit-color-border-elevation-base);

    // Use StrataKit's shadow instead of iTwinUI's
    box-shadow: var(--stratakit-shadow-tooltip-base);
  }
}
