// Copyright (c) Bentley Systems, Incorporated. All rights reserved.
// See LICENSE.md in the project root for license terms and full copyright notice.
@use '../mixins';

@mixin iui-progress-indicator-linear-wrapper {
  display: flex;
  flex-direction: column;
  gap: var(--iui-size-2xs);

  @supports selector(:has(*)) {
    @each $status in positive, negative {
      &:has([data-iui-status='#{$status}']) {
        --_iui-progress-indicator-linear-wrapper-label-color: var(--iui-color-text-#{$status});
        --_iui-progress-indicator-linear-wrapper-label-fill: var(--iui-color-icon-#{$status});
        @include mixins.iui-text-selection($status);
      }
    }
  }
}

@mixin iui-progress-indicator-linear-wrapper-label {
  align-items: center;
  width: 100%;
  overflow: hidden;
  display: flex;
  font-size: var(--iui-font-size-0);
  justify-content: space-between;
  color: var(--_iui-progress-indicator-linear-wrapper-label-color);

  > :only-child {
    margin: 0 auto;
  }

  > :last-child:not(:first-child) {
    user-select: none;
  }

  svg {
    @include mixins.iui-icon-style('m');
    fill: var(--_iui-progress-indicator-linear-wrapper-label-fill);
  }
}

@mixin iui-progress-indicator-linear {
  width: 100%;
  height: var(--iui-size-2xs);
  overflow: hidden;
  background-color: var(--iui-color-border);

  @media (forced-colors: active) {
    border: 1px solid;
  }

  &::after {
    content: '';
    position: absolute;
    inset: 0;
    width: var(--iui-progress-percentage, 100%);
    background-color: var(--iui-color-border-accent);
    forced-color-adjust: none;
  }

  @each $status in positive, negative {
    &[data-iui-status='#{$status}'] {
      &::after {
        background-color: var(--iui-color-border-#{$status});
      }

      @supports not selector(:has(*)) {
        + .iui-progress-indicator-linear-wrapper-label {
          --_iui-progress-indicator-linear-wrapper-label-color: var(--iui-color-text-#{$status});
          --_iui-progress-indicator-linear-wrapper-label-fill: var(--iui-color-icon-#{$status});
          @include mixins.iui-text-selection($status);
        }
      }
    }
  }
}

@mixin iui-progress-indicator-linear-determinate($speed: 2s) {
  &::after {
    transition: width $speed ease-in-out;
  }
}

@mixin iui-progress-indicator-linear-indeterminate() {
  @keyframes iui-progress-indicator-linear-animate-indeterminate {
    0% {
      transform: translateX(-60%) scaleX(0);
    }

    40% {
      transform: translateX(-40%) scaleX(0.4);
    }

    100% {
      transform: translateX(100%) scaleX(0.5);
    }
  }

  &::after {
    width: 100%;
    animation: iui-progress-indicator-linear-animate-indeterminate 1.5s infinite linear;
  }
}
