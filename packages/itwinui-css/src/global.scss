// Copyright (c) Bentley Systems, Incorporated. All rights reserved.
// See LICENSE.md in the project root for license terms and full copyright notice.
@use 'mixins';

@mixin iui-scrollbar {
  scrollbar-color: hsl(var(--iui-color-foreground-hsl) / var(--iui-opacity-4)) transparent;
  scrollbar-width: thin;

  &::-webkit-scrollbar {
    max-inline-size: var(--iui-size-xs);
    max-block-size: var(--iui-size-xs);
  }

  &::-webkit-scrollbar-thumb {
    background-color: hsl(var(--iui-color-foreground-hsl) / var(--iui-opacity-4));
    border-radius: var(--iui-border-radius-round);

    &:hover {
      background-color: hsl(var(--iui-color-foreground-hsl) / var(--iui-opacity-3));
    }
  }

  &::-webkit-scrollbar-track,
  &::-webkit-scrollbar-corner {
    background-color: transparent;
  }
}

:where(.iui-root) {
  color: var(--iui-color-text);
  font-size: var(--iui-font-size-1);
  line-height: 1.5;
  font-family: var(--iui-font-sans);
}

// reset margin only for <body> element.
:where(body.iui-root) {
  margin: 0;
}

// auto apply background only if <body> is used as root.
// for other elements, user will have to opt in by adding .iui-root-background
:where(body.iui-root, .iui-root.iui-root-background) {
  background-color: var(--iui-color-background-backdrop);
}

// box-sizing, text selection and scrollbar styling on iui-root and all elements under it
:where(.iui-root, .iui-root *) {
  @include mixins.iui-text-selection;
  @include iui-scrollbar;

  &,
  &::before,
  &::after {
    box-sizing: border-box;
  }

  &:where(:focus-visible) {
    outline: 2px solid var(--iui-color-border-accent);
  }
}

@include mixins.animations;

:where(.iui-field) {
  --_iui-field-color-text: var(--iui-color-text);
  --_iui-field-color-text-hover: var(--iui-color-text-hover);
  --_iui-field-color-text-disabled: var(--iui-color-text-disabled);
  --_iui-field-color-background: var(--iui-color-background);
  --_iui-field-color-background-hover: var(--iui-color-background-hover);
  --_iui-field-color-background-disabled: var(--iui-color-background-disabled);
  --_iui-field-color-border: var(--iui-color-border-foreground);
  --_iui-field-color-border-hover: var(--iui-color-border-foreground-hover);
  --_iui-field-color-border-disabled: var(--iui-color-border-disabled);
  --_iui-field-color-focus-outline: var(--iui-color-border-accent);
  --_iui-field-height: var(--iui-component-height);

  background-color: var(--_iui-field-color-background);
  border: 1px solid var(--_iui-field-color-border);
  border-radius: var(--iui-border-radius-1);
  color: var(--_iui-field-color-text);
  font-family: inherit;
  min-block-size: var(--_iui-field-height);
  min-inline-size: var(--_iui-field-height);
  -webkit-tap-highlight-color: var(--_iui-field-color-background-hover);
  transition:
    background-color var(--iui-duration-1) ease-out,
    border-color var(--iui-duration-1) ease-out,
    color var(--iui-duration-1) ease-out;

  // outline: 4px solid red;

  @media (hover: hover) {
    &:where(:hover) {
      background-color: var(--_iui-field-color-background-hover);
      border-color: var(--_iui-field-color-border-hover);
      color: var(--_iui-field-color-text-hover);
    }
  }

  &:where(:active) {
    background-color: var(--_iui-field-color-background-hover);
    border-color: var(--_iui-field-color-border-hover);
    color: var(--_iui-field-color-text-hover);
  }

  &:where(:focus-visible) {
    outline: 2px solid var(--_iui-field-color-focus-outline);
    outline-offset: 2px;
  }

  &:where([disabled], :disabled, [aria-disabled='true'], [data-iui-disabled='true'], .iui-disabled) {
    background-color: var(--_iui-field-color-background-disabled);
    border-color: var(--_iui-field-color-border-disabled);
    color: var(--_iui-field-color-text-disabled);
    cursor: not-allowed;
  }

  // #region Color variants
  &:where([data-iui-variant='borderless']) {
    --_iui-field-color-background: transparent;
    --_iui-field-color-background-hover: var(--iui-color-background-transparent-hover);
    --_iui-field-color-background-disabled: transparent;
    --_iui-field-color-border: transparent;
    --_iui-field-color-border-hover: transparent;
    --_iui-field-color-border-disabled: transparent;
  }

  @each $fieldColor in accent, informational, positive, warning, negative {
    &:where([data-iui-variant='#{$fieldColor}']) {
      --_iui-field-color-text: var(--iui-color-white);
      --_iui-field-color-text-hover: var(--iui-color-white);
      --_iui-field-color-background: var(--iui-color-background-#{$fieldColor});
      --_iui-field-color-background-hover: var(--iui-color-background-#{$fieldColor}-hover);
      --_iui-field-color-border: var(--iui-color-background-#{$fieldColor});
      --_iui-field-color-border-hover: var(--iui-color-background-#{$fieldColor}-hover);
      --_iui-field-color-focus-outline: var(--iui-color-border-#{$fieldColor});
    }
  }
  // #endregion Color variants

  @each $fieldSize in small, large {
    &:where([data-iui-size='#{$fieldSize}']) {
      --_iui-field-height: var(--iui-component-height-#{$fieldSize});
    }
  }
}
