import{p as ne,r as e,h as K,V as se,c as k,O as D,m as W,n as ie,o as ue,z as oe,f as H,B as M,F as ce,N as me,Q as de,U as fe}from"./index-COFFLrzD.js";import{M as ve}from"./MenuItem-DQ2UtZTV.js";import{T as Ee}from"./Tag-DacjZJB_.js";import{I as be}from"./Icon-dIm5m99N.js";import{L as ge}from"./List-21blDBdx.js";import{S as he}from"./SvgCheckmark-D2iKggtV.js";import{S as Se}from"./SvgCaretDownSmall-BCNaVcqE.js";const P=ne.div("iui-input-with-icon"),Ce=({text:t,...r})=>{let[l,n]=e.useState(t);return e.useEffect(()=>{var u;n(t);let s=(u=K())==null?void 0:u.setTimeout(()=>n(""),5e3);return()=>{var E;return void((E=K())==null?void 0:E.clearTimeout(s))}},[t]),e.createElement(se,{as:"div","aria-live":"polite","aria-atomic":"true",...r},l)},U=e.forwardRef((t,r)=>{let{className:l,label:n,...s}=t;return e.createElement(Ee,{className:k("iui-select-tag",l),labelProps:{className:"iui-select-tag-label"},removeButtonProps:{className:"iui-select-tag-button","aria-label":`Deselect ${n}`},ref:r,...s},n)}),ye=e.forwardRef((t,r)=>{let{tags:l,className:n,...s}=t,u=e.useMemo(()=>e.Children.toArray(l),[l]);return e.createElement(D,{itemsCount:u.length,className:k("iui-select-tag-container",n),ref:r,...s},e.createElement(Ne,{...t,tags:u}))});let Ne=t=>{let{tags:r}=t,{visibleCount:l}=D.useContext();return e.createElement(e.Fragment,null,l<r.length?r.slice(0,l-1):r,e.createElement(D.OverflowNode,null,e.createElement(U,{label:`+${r.length-l+1} item(s)`})))};const Le=e.forwardRef((t,r)=>{let{native:l,...n}=t,s=l?xe:pe;return e.createElement(s,{...n,ref:r})});let xe=e.forwardRef((t,r)=>{let{triggerProps:l,options:n,disabled:s,placeholder:u,defaultValue:E=u!==void 0?"":void 0,value:v,onChange:h,size:N,status:p,styleType:d,required:b,...m}=t;return e.createElement(P,{...m,ref:r},e.createElement(j,{as:"select",size:N,status:p,styleType:d,disabled:s,defaultValue:v===void 0?E:void 0,value:v===null?"":v,required:b,...l,onKeyDown:W(l==null?void 0:l.onKeyDown,o=>{var F,I;o.key==="Enter"&&((I=(F=o.currentTarget).showPicker)==null||I.call(F))}),onChange:W(l==null?void 0:l.onChange,o=>{h==null||h(o.currentTarget.value,o)})},d!=="borderless"&&u!==void 0?e.createElement("option",{value:"",disabled:!0},u):null,n.map(o=>e.createElement("option",{key:o.value,...o},o.label))),e.createElement(Q,{disabled:s}))}),pe=e.forwardRef((t,r)=>{let l=ie(),{options:n,value:s,onChange:u,placeholder:E,disabled:v=!1,size:h,itemRenderer:N,selectedItemRenderer:p,menuClassName:d,menuStyle:b,multiple:m=!1,triggerProps:o,status:F,popoverProps:{portal:I=!0,...f}={},styleType:_,...G}=t,[B,$]=e.useState(!1),[J,X]=e.useState(""),[Y,q]=e.useState(),i=s!==void 0?s:Y,S=ue(u),L=e.useRef(null),Z=e.useCallback(()=>{var a;v||($(!0),(a=f==null?void 0:f.onVisibleChange)==null||a.call(f,!0))},[v,f]),O=e.useCallback(()=>{var a,c;$(!1),(a=L.current)==null||a.focus({preventScroll:!0}),(c=f==null?void 0:f.onVisibleChange)==null||c.call(f,!1)},[f]),z=e.useCallback((a,{isSelected:c=!1}={})=>{var y,R;if(we(S.current,m)?(q(a.value),(y=S.current)==null||y.call(S,a.value),O()):(q(g=>c?g==null?void 0:g.filter(T=>a.value!==T):[...g??[],a.value]),(R=S.current)==null||R.call(S,a.value,c?"removed":"added")),V(i,m)){let g=i||[],T=c?g.filter(x=>a.value!==x):[...g,a.value];X(n.filter(x=>T.includes(x.value)).map(x=>x.label).filter(Boolean).join(", "))}},[O,m,S,n,i]),ee=e.useMemo(()=>n.map((a,c)=>{let y=V(i,m)?(i==null?void 0:i.includes(a.value))??!1:i===a.value,R=N?N(a,{close:()=>$(!1),isSelected:y}):e.createElement(ve,null,a.label),{label:g,icon:T,startIcon:x,value:Ve,...le}=a,re=x??T;return e.cloneElement(R,{key:`${g}-${c}`,isSelected:y,startIcon:re,endIcon:y?e.createElement(he,{"aria-hidden":!0}):null,onClick:()=>{a.disabled||z(a,{isSelected:y})},ref:A=>{y&&!m&&(A==null||A.scrollIntoView({block:"nearest"}))},role:"option",...le,...R.props})}),[z,N,m,n,i]),C=e.useMemo(()=>{if(i!=null)return V(i,m)?n.filter(a=>i.some(c=>c===a.value)):n.find(a=>a.value===i)},[m,n,i]),te=e.useMemo(()=>{let a=0;return Array.isArray(i)&&i.length>0?a=n.findIndex(c=>c.value===i[0]):i&&(a=n.findIndex(c=>c.value===i)),a>=0?a:0},[n,i]),ae=e.useCallback(a=>e.createElement(U,{key:a.label,label:a.label,onRemove:()=>{var c;z(a,{isSelected:!0}),(c=L.current)==null||c.focus()}}),[z]),w=oe({visible:B,matchWidth:!0,closeOnOutsideClick:!0,middleware:{size:{maxHeight:"var(--iui-menu-max-height)"}},...f,onVisibleChange:a=>a?Z():O()});return e.createElement(e.Fragment,null,e.createElement(P,{...G,ref:H(w.refs.setPositionReference,r)},e.createElement(j,{...w.getReferenceProps(),tabIndex:0,role:"combobox",size:h,status:F,"aria-disabled":v?"true":void 0,"data-iui-disabled":v?"true":void 0,"aria-autocomplete":"none","aria-expanded":B,"aria-haspopup":"listbox","aria-controls":`${l}-menu`,styleType:_,...o,ref:H(L,o==null?void 0:o.ref,w.refs.setReference),className:k({"iui-placeholder":(!C||C.length===0)&&!!E},o==null?void 0:o.className),"data-iui-multi":m},(!C||C.length===0)&&e.createElement(M,{as:"span",className:"iui-content"},E),V(C,m)?e.createElement(Ce,{text:J}):e.createElement(ke,{selectedItem:C,selectedItemRenderer:p})),e.createElement(Q,{disabled:v,isOpen:B}),V(C,m)?e.createElement(Re,{selectedItems:C,selectedItemsRenderer:p,tagRenderer:ae,size:h==="small"?"small":void 0}):null),w.open&&e.createElement(ce,{portal:I},e.createElement(Te,{defaultFocusedIndex:te,className:d,id:`${l}-menu`,key:`${l}-menu`,...w.getFloatingProps({style:b,onKeyDown:({key:a})=>{a==="Tab"&&O()}}),ref:w.refs.setFloating},ee)))}),V=(t,r)=>r,we=(t,r)=>!r,j=e.forwardRef((t,r)=>{let{size:l,status:n,styleType:s="default",...u}=t;return e.createElement(M,{"data-iui-size":l,"data-iui-status":n,"data-iui-variant":s!=="default"?s:void 0,...u,ref:r,className:k("iui-select-button","iui-field",t.className)})}),Q=e.forwardRef((t,r)=>{let{disabled:l,isOpen:n,...s}=t;return e.createElement(be,{"aria-hidden":!0,...s,ref:r,className:k("iui-end-icon",{"iui-disabled":l,"iui-open":n},t.className)},e.createElement(Se,null))}),ke=({selectedItem:t,selectedItemRenderer:r})=>{let l=(t==null?void 0:t.startIcon)??(t==null?void 0:t.icon);return e.createElement(e.Fragment,null,t&&r&&r(t),t&&!r&&e.createElement(e.Fragment,null,l&&e.createElement(M,{as:"span",className:"iui-icon","aria-hidden":!0},l),e.createElement(M,{as:"span",className:"iui-content"},t.label)))},Re=({selectedItems:t,selectedItemsRenderer:r,tagRenderer:l,size:n})=>{let s=e.useMemo(()=>t?t.map(u=>l(u)):[],[t,l]);return e.createElement(e.Fragment,null,t&&e.createElement(M,{as:"span",className:"iui-content"},r?r(t):e.createElement(ye,{tags:s,"data-iui-size":n})))},Te=e.forwardRef((t,r)=>{let{defaultFocusedIndex:l=0,autoFocus:n=!0,children:s,className:u,...E}=t,[v,h]=e.useState(l),N=e.useCallback(d=>{queueMicrotask(()=>{let b=d==null?void 0:d.querySelector('[tabindex="0"]');b==null||b.focus()})},[]),p=e.useMemo(()=>e.Children.map(s,(d,b)=>{if(e.isValidElement(d)){let m=me?d.ref:d.props.ref;return e.createElement(de,{key:b,ref:m,render:d})}return d}),[s]);return e.createElement(fe,{render:e.createElement(ge,{as:"div",className:k("iui-menu",u)}),orientation:"vertical",role:"listbox",activeIndex:v,onNavigate:h,ref:H(r,n?N:void 0),...E},p)});export{Ce as A,P as I,Le as S,ye as a,U as b};
