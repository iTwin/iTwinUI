---
import SkipLink from './utils/SkipLink.astro';
import SidebarToggle from './SidebarToggle.astro';
import VisuallyHidden from './utils/VisuallyHidden.astro';
import { SearchModal } from './SearchModal/SearchModal.jsx';

export type Props = { class?: string };

const { pathname } = Astro.url;
---

<header class={Astro.props.class}>
  <SkipLink />

  {pathname !== '/' && <SidebarToggle />}

  <a href='/' class='logo'>
    <VisuallyHidden>iTwinUI home</VisuallyHidden>
    <svg
      width='133.6'
      height='32'
      xmlns='http://www.w3.org/2000/svg'
      viewBox='0 0 1059.88 284.43'
      fill='currentColor'
    >
      <g id='Monochrome'>
        <path
          d='M252.38,84.16v119.61c0,8.53-4.8,16.71-12.26,20.97l-96.51,56.87c-6.42,3.75-14.37,3.75-20.79,0-6.58-3.91-10.49-10.66-10.49-18.31v-96.68c-.03-.78-.42-1.51-1.07-1.96l-16.53-9.6c-6.67-3.95-8.89-12.56-4.94-19.23,2.52-4.26,7.1-6.88,12.05-6.89,2.5,.02,4.95,.69,7.11,1.96l19.19,11.73c7.29,4.27,11.91,12.26,11.91,20.79v88.15l83.53-49.59c.71-.36,1.07-1.07,1.07-1.78V87.18c-.07-.82-.53-1.55-1.24-1.96L127.08,29.24c-.36-.26-.8-.38-1.24-.36-.36,0-.89,0-1.07,.36L28.79,85.76c-.71,.32-1.18,1-1.24,1.78l.18,113.04c0,.71,.53,1.42,1.07,1.78l2.67,1.78,50.48,29.33,1.78,1.07c.89,.89,1.78,1.78,2.49,3.02,4.52,6.42,2.98,15.29-3.45,19.81-2.28,1.6-4.97,2.5-7.75,2.58-1.78,0-3.55-.36-5.15-1.07l-48.88-28.79-6.04-3.55-2.67-1.6C4.62,220.55-.07,212.4,0,203.6V84.34C0,75.45,4.8,67.28,12.44,63.01L114.1,3.29c7.46-4.39,16.71-4.39,24.17,0l101.84,59.54c7.46,4.44,12.09,12.44,12.09,21.15l.18,.18Zm-126.19,30.75c9.95,0,18.13-8.35,18.13-18.48s-8.18-18.31-18.13-18.31-18.13,8.18-18.13,18.31,8.18,18.48,18.13,18.48Z'
        ></path>
        <path
          d='M339.86,114.65c0-4.95,2.47-7.42,7.42-7.42h6.97c4.95,0,7.42,2.47,7.42,7.42v98.92c0,4.95-2.47,7.42-7.42,7.42h-6.97c-4.95,0-7.42-2.47-7.42-7.42V114.65Zm91.91-33.05h-47.21c-4.95,0-7.42-2.47-7.42-7.42v-4.5c0-4.95,2.47-7.42,7.42-7.42h116.45c4.79,0,7.19,2.47,7.19,7.42v4.5c0,4.95-2.4,7.42-7.19,7.42h-47.21V213.57c0,4.95-2.47,7.42-7.42,7.42h-7.42c-4.8,0-7.19-2.47-7.19-7.42V81.61Zm65.42,33.95c-.75-2.55-.56-4.57,.56-6.07,1.12-1.5,3.04-2.25,5.73-2.25h7.42c4.5,0,7.27,2.1,8.32,6.29l22.26,73.51c.3,1.5,.64,2.96,1.01,4.38,.37,1.43,.71,2.74,1.01,3.93,.3,1.35,.52,2.62,.68,3.82h.45c.15-1.2,.45-2.47,.9-3.82,.3-1.2,.64-2.51,1.01-3.93,.37-1.42,.79-2.88,1.24-4.38l22.93-73.29c.9-4.19,3.6-6.29,8.09-6.29h6.97c4.5,0,7.27,2.1,8.32,6.29l22.93,73.29c.3,1.5,.64,2.96,1.01,4.38,.37,1.43,.71,2.74,1.01,3.93,.3,1.35,.6,2.62,.9,3.82h.45c.15-1.2,.37-2.47,.67-3.82,.3-1.2,.64-2.51,1.01-3.93,.37-1.42,.79-2.88,1.24-4.38l22.26-73.51c.9-4.19,3.6-6.29,8.09-6.29h7.42c2.7,0,4.61,.75,5.73,2.25,1.12,1.5,1.31,3.52,.56,6.07l-32.15,99.14c-1.05,4.2-3.82,6.3-8.32,6.3h-11.02c-4.5,0-7.27-2.1-8.32-6.3l-21.81-66.77c-.6-1.5-1.05-2.96-1.35-4.38-.3-1.42-.6-2.73-.9-3.93-.3-1.35-.6-2.7-.9-4.05h-.45c-.15,1.35-.45,2.7-.9,4.05-.3,1.2-.67,2.51-1.12,3.93-.45,1.43-.9,2.89-1.35,4.38l-21.58,66.77c-1.05,4.2-3.82,6.3-8.32,6.3h-11.24c-4.5,0-7.27-2.1-8.32-6.3l-32.15-99.14Zm191.53-.9c0-4.95,2.47-7.42,7.42-7.42h6.97c4.95,0,7.42,2.47,7.42,7.42v98.92c0,4.95-2.47,7.42-7.42,7.42h-6.97c-4.95,0-7.42-2.47-7.42-7.42V114.65Zm52.84,0c0-4.95,2.47-7.42,7.42-7.42h6.29c4.95,0,7.42,2.47,7.42,7.42v10.12c0,1.5-.15,3-.45,4.5-.15,.6-.23,1.27-.23,2.02h.45c1.05-2.4,2.73-5.17,5.06-8.32,2.32-3.15,5.28-6.07,8.88-8.77,3.6-2.7,7.79-4.98,12.59-6.86,4.79-1.87,10.34-2.81,16.64-2.81,13.49,0,23.34,3.64,29.56,10.9,6.22,7.27,9.33,18.17,9.33,32.71v65.42c0,4.95-2.47,7.42-7.42,7.42h-6.97c-4.95,0-7.42-2.47-7.42-7.42v-60.47c0-4.05-.26-7.79-.79-11.24-.53-3.45-1.54-6.44-3.04-8.99-1.5-2.55-3.67-4.57-6.52-6.07-2.85-1.5-6.52-2.25-11.02-2.25-5.55,0-10.64,1.09-15.29,3.26-4.65,2.17-8.66,5.14-12.03,8.88-3.37,3.75-6,8.21-7.87,13.38-1.88,5.17-2.81,10.68-2.81,16.52v46.99c0,4.95-2.47,7.42-7.42,7.42h-6.97c-4.95,0-7.42-2.47-7.42-7.42V114.65Zm133.08-44.96c0-4.95,2.47-7.42,7.42-7.42h7.42c4.8,0,7.19,2.47,7.19,7.42v94.87c0,12.14,3.67,21.62,11.02,28.44,7.34,6.82,17.08,10.23,29.22,10.23s21.88-3.41,29.22-10.23c7.34-6.82,11.02-16.37,11.02-28.66V69.69c0-4.95,2.47-7.42,7.42-7.42h7.42c4.95,0,7.42,2.47,7.42,7.42v95.09c0,8.84-1.5,16.86-4.5,24.05-3,7.19-7.23,13.38-12.7,18.55-5.47,5.17-12.03,9.18-19.67,12.03-7.64,2.84-16.11,4.27-25.4,4.27s-17.8-1.43-25.52-4.27c-7.72-2.84-14.31-6.86-19.78-12.03-5.47-5.17-9.7-11.35-12.7-18.55-3-7.19-4.5-15.21-4.5-24.05V69.69Zm163.21,0c0-4.95,2.47-7.42,7.42-7.42h7.19c4.95,0,7.42,2.47,7.42,7.42V213.57c0,4.95-2.47,7.42-7.42,7.42h-7.19c-4.95,0-7.42-2.47-7.42-7.42V69.69Zm-687.08,14.27c6.28,0,11.44-5.27,11.44-11.67s-5.16-11.55-11.44-11.55-11.44,5.16-11.44,11.55,5.16,11.67,11.44,11.67Zm348.85,0c6.28,0,11.44-5.27,11.44-11.67s-5.16-11.55-11.44-11.55-11.44,5.16-11.44,11.55,5.16,11.67,11.44,11.67Z'
        ></path>
      </g>
    </svg>
  </a>

  <nav aria-label='Global site'>
    {pathname === '/' && <a href='/docs'>Documentation</a>}

    <a href='https://www.github.com/iTwin/iTwinUI' class='action-item'>
      <VisuallyHidden>GitHub</VisuallyHidden>

      <svg width='32' height='32' viewBox='0 0 24 24' fill='currentColor'
        ><path
          d='M12.026 2a9.975 9.975 0 0 0-3.153 19.439c.5.09.679-.217.679-.481c0-.237-.008-.865-.011-1.7c-2.775.6-3.361-1.338-3.361-1.338a2.635 2.635 0 0 0-1.107-1.459c-.9-.619.069-.605.069-.605c.64.088 1.205.467 1.527 1.028a2.124 2.124 0 0 0 2.9.829c.046-.506.272-.979.635-1.334c-2.214-.251-4.542-1.107-4.542-4.93a3.865 3.865 0 0 1 1.026-2.671a3.588 3.588 0 0 1 .1-2.64s.837-.269 2.742 1.021a9.439 9.439 0 0 1 4.992 0c1.906-1.291 2.742-1.021 2.742-1.021c.37.835.405 1.78.1 2.64a3.84 3.84 0 0 1 1.024 2.675c0 3.833-2.33 4.675-4.552 4.922c.48.49.725 1.162.675 1.846c0 1.334-.012 2.41-.012 2.737c0 .267.178.577.687.479A9.975 9.975 0 0 0 12.026 2Z'
        ></path>
      </svg>
    </a>

    <button id='search-action-item' class='action-item'>
      <VisuallyHidden>Search</VisuallyHidden>

      <svg width='32' height='32' viewBox='0 0 24 24' fill='currentColor'>
        <path
          d='M11 9.7c.7-1 1.1-2.2 1.1-3.5.1-3.5-2.7-6.2-6-6.2C2.7 0 0 2.7 0 6.1s2.7 6.1 6.1 6.1c1.3 0 2.5-.4 3.5-1.1l4.9 4.9 1.4-1.4zm-5 .5c-2.3 0-4.1-1.8-4.1-4.1S3.7 2 6 2s4.1 1.8 4.1 4.1-1.8 4.1-4.1 4.1'
        ></path>
      </svg>
    </button>

    <SearchModal client:load />
  </nav>
</header>

<script>
  import { isSearchOpen } from '~/stores/header.store.js';

  const button = document.getElementById('search-action-item');
  button.addEventListener('click', () => {
    isSearchOpen.set(!isSearchOpen.get());
  });
</script>

<style lang='scss'>
  header {
    z-index: 11;
    width: 100%;
    height: calc(5 * var(--space-3));
    padding: 0 var(--space-3);
    display: grid;
    align-items: center;
    justify-content: center;
    border-bottom: 1px solid var(--color-line-2);
    grid-template-columns: auto 1fr auto;

    @media (max-width: 50em) {
      grid-template-columns: 1fr auto 1fr;
    }
  }

  .logo {
    display: flex;
    align-items: center;
    font-size: var(--type-3);
    flex-shrink: 0;
    gap: 0.25em;
    text-decoration: none;
    color: var(--color-text);
    outline-offset: -1px;
    grid-column-start: 1;

    @media (max-width: 50em) {
      grid-column-start: 2;
    }
  }

  nav {
    display: flex;
    gap: var(--space-2);
    align-items: center;
    margin-left: auto;

    @media (max-width: 50em) {
      display: none;
    }
  }

  a,
  button {
    display: flex;
    align-items: center;
    border-radius: var(--border-radius-1);
    padding: var(--space-2) var(--space-3);
    color: var(--color-text);
    text-decoration: none;
    opacity: 0.9;

    &:hover {
      opacity: 1;
      background-color: var(--color-active);
    }
  }

  .action-item {
    display: flex;
    border-radius: 9e9px;
    padding: var(--space-2);
    cursor: pointer;

    svg {
      width: 1.5em;
      height: 1.5em;
    }
  }
</style>
