// Copyright (c) Bentley Systems, Incorporated. All rights reserved.
// See LICENSE.md in the project root for license terms and full copyright notice.
@import '../style/index';
@import '../icon/index';

/// Container for grouping an input with a label and status message.
@mixin iui-input-container {
  @include iui-reset;
  display: flex;
  flex-direction: column;
  position: relative;
  cursor: default;

  @at-root {
    label#{&} {
      cursor: pointer;
    }
  }

  &.iui-disabled {
    cursor: not-allowed;
  }

  // Appropriate spacing even if no text label is given
  > .iui-checkbox,
  > .iui-radio {
    min-height: $iui-line-height;
  }

  &.iui-inline {
    flex-direction: row;
    align-items: center;

    > .iui-checkbox:not(:last-child),
    > .iui-radio:not(:last-child),
    > .iui-toggle-switch:not(:last-child) {
      margin-right: $iui-m;
    }

    > .iui-input,
    > .iui-textarea {
      padding-right: $iui-icons-default + $iui-l;

      + .iui-message {
        position: absolute;
        top: 50%;
        right: 0;
        transform: translateY(-50%);

        svg {
          margin-right: $iui-sm;
        }
      }

      &:last-child {
        padding-right: $iui-sm;
      }
    }
  }

  // #region Statuses
  &.iui-positive {
    @include iui-inputs-status(
      iui-color-foreground-positive,
      iui-color-foreground-positive-overlay,
      iui-color-foreground-positive-rgb
    );
  }

  &.iui-warning {
    @include iui-inputs-status(
      iui-color-foreground-warning,
      iui-color-foreground-warning-overlay,
      iui-color-foreground-warning-rgb
    );
  }

  &.iui-negative {
    @include iui-inputs-status(
      iui-color-foreground-negative,
      iui-color-foreground-negative-overlay,
      iui-color-foreground-negative-rgb
    );
  }
  // #endregion
}

/// Text label for an input.
/// Supports .iui-required modifier to show red asterisk.
@mixin iui-input-label {
  margin-bottom: $iui-component-offset;
  font-weight: $iui-font-weight-semibold;

  &.iui-required {
    &::after {
      content: ' *';
      margin-right: 0;
      @include themed {
        color: t(iui-color-foreground-negative);
      }
    }
  }
}

/// Modifier mixin on iui-input-label to show inline label.
@mixin iui-input-label-inline {
  flex-shrink: 0;
  margin: 0 ($iui-m + 2) 0 0;

  &.iui-required {
    margin-right: $iui-s;
  }
}

/// Message shown below input
@mixin iui-input-status-message($displayStyle: default) {
  display: flex;
  align-items: center;
  font-size: $iui-font-size-small;
  margin-top: $iui-component-offset;
  @include themed {
    color: t(iui-text-color-muted);
  }

  svg,
  :not(.iui-button) svg {
    width: $iui-icons-default;
    height: $iui-icons-default;
    margin-right: $iui-xs;
    @include themed {
      fill: t(iui-icons-color);
    }
  }

  > .iui-borderless {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
  }

  a {
    user-select: none;
  }
}

/// Modifier mixin on iui-input-status-message to hide message.
@mixin iui-input-status-message-inline {
  margin: 0;

  svg,
  :not(.iui-button) svg {
    margin-right: 0;
  }
}

@mixin iui-inputs-status($foregroundColor, $foregroundOverlay, $foregroundRgb) {
  *::selection {
    @include themed {
      background-color: rgba(t($foregroundRgb), t(iui-opacity-4));
    }
  }

  > .iui-message {
    @include themed {
      color: t($foregroundColor);
    }

    svg {
      @include themed {
        fill: t($foregroundColor);
      }
    }

    a {
      text-decoration: underline;

      @include themed {
        color: t($foregroundColor);
      }

      &:hover {
        text-decoration: none;

        @include themed {
          color: t($foregroundOverlay);
        }
      }
    }
  }

  > input,
  > .iui-input,
  > textarea,
  > .iui-textarea,
  > .iui-select > .iui-select-button {
    padding-bottom: $iui-component-padding-vertical - 1px;

    &.iui-small {
      padding-bottom: $iui-component-padding-vertical-small - 1px;
    }

    &.iui-large {
      padding-bottom: $iui-component-padding-vertical-large - 1px;
    }

    @include themed {
      border-bottom: 2px solid t($foregroundColor);
    }

    &:focus {
      @include themed {
        border-bottom: 2px solid t($foregroundColor);
        box-shadow: rgba(t($foregroundRgb), t(iui-opacity-5)) 0 0 0 2px;
      }
    }
  }
}
