// Copyright (c) Bentley Systems, Incorporated. All rights reserved.
// See LICENSE.md in the project root for license terms and full copyright notice.
// LIGHT THEME //
// Light theme > Background
$iui-color-background-1--light: #FFF;
$iui-color-background-2--light: #F8F9FB;
$iui-color-background-3--light: #EEF0F3;
$iui-color-background-4--light: #DCE0E3;
$iui-color-background-5--light: #C7CCD1;
$iui-color-background-primary--light: #008BE1;
$iui-color-background-positive--light: #53A21A;
$iui-color-background-negative--light: #D30A0A;
$iui-color-background-warning--light: #F18B12;
$iui-color-background-disabled--light: $iui-color-background-3--light;

// Light theme > Foreground
$iui-color-foreground-body--light: #000;
$iui-color-foreground-body-invert--light: #FFF;
$iui-color-foreground-accessory--light: #FFF;
$iui-color-foreground-primary--light: #008BE1;
$iui-color-foreground-positive--light: #53A21A;
$iui-color-foreground-negative--light: #D30A0A;
$iui-color-foreground-warning--light: #F18B12;

// Light theme > Overlays
$iui-color-background-1-overlay--light: darken($iui-color-background-1--light, 5%);
$iui-color-background-primary-overlay--light: darken($iui-color-background-primary--light, 10%);
$iui-color-background-positive-overlay--light: darken($iui-color-background-positive--light, 10%);
$iui-color-foreground-primary-overlay--light: darken($iui-color-foreground-primary--light, 10%);
$iui-color-foreground-positive-overlay--light: darken($iui-color-foreground-positive--light, 10%);
$iui-color-foreground-warning-overlay--light: darken($iui-color-foreground-warning--light, 10%);
$iui-color-foreground-negative-overlay--light: darken($iui-color-foreground-negative--light, 10%);

// Light theme > Opacity stops
$iui-opacity-1--light: 1;
$iui-opacity-2--light: 0.8;
$iui-opacity-3--light: 0.6;
$iui-opacity-4--light: 0.4;
$iui-opacity-5--light: 0.2;
$iui-opacity-6--light: 0.1;

// Light theme > Text colors
$iui-text-color--light: rgba($iui-color-foreground-body--light, $iui-opacity-2--light);
$iui-text-color-muted--light: rgba($iui-color-foreground-body--light, $iui-opacity-4--light);
$iui-text-color-placeholder--light: rgba($iui-color-foreground-body--light, $iui-opacity-5--light);

// Light theme > Focus color
$iui-focus-box-shadow--light: rgba($iui-color-foreground-primary--light, $iui-opacity-5--light) 0 0 0 2px;
$iui-focus-positive-box-shadow--light: rgba($iui-color-foreground-positive--light, $iui-opacity-5--light) 0 0 0 2px;
$iui-focus-warning-box-shadow--light: rgba($iui-color-foreground-warning--light, $iui-opacity-5--light) 0 0 0 2px;
$iui-focus-negative-box-shadow--light: rgba($iui-color-foreground-negative--light, $iui-opacity-5--light) 0 0 0 2px;

// Light theme > Icon colors
$iui-icons-color--light: rgba($iui-color-foreground-body--light, $iui-opacity-4--light);
$iui-icons-color-actionable--light: rgba($iui-color-foreground-body--light, $iui-opacity-2--light);
$iui-icons-color-actionable-hover--light: rgba($iui-color-foreground-body--light, $iui-opacity-1--light);
$iui-icons-color-actionable-disabled--light: rgba($iui-color-foreground-body--light, $iui-opacity-5--light);
$iui-icons-color-primary--light: $iui-color-foreground-primary--light;
$iui-icons-color-positive--light: $iui-color-foreground-positive--light;
$iui-icons-color-negative--light: $iui-color-foreground-negative--light;
$iui-icons-color-warning--light: $iui-color-foreground-warning--light;

// DARK THEME //
// Dark theme > Background
$iui-color-background-1--dark: #5A6973;
$iui-color-background-2--dark: #4F5D65;
$iui-color-background-3--dark: #445058;
$iui-color-background-4--dark: #38444A;
$iui-color-background-5--dark: #2D373C;
$iui-color-background-primary--dark: #008BE1;
$iui-color-background-positive--dark: #53A21A;
$iui-color-background-negative--dark: #D30A0A;
$iui-color-background-warning--dark: #F18B12;
$iui-color-background-disabled--dark: $iui-color-background-3--dark;

// Dark theme > Foreground
$iui-color-foreground-body--dark: #FFF;
$iui-color-foreground-body-invert--dark: #000;
$iui-color-foreground-accessory--dark: #FFF;
$iui-color-foreground-primary--dark: #A5D7F5;
$iui-color-foreground-positive--dark: #C3E1AF;
$iui-color-foreground-negative--dark: #EFA9A9;
$iui-color-foreground-warning--dark: #F9D7AB;

// Dark theme > Overlays
$iui-color-background-1-overlay--dark: lighten($iui-color-background-1--dark, 5%);
$iui-color-background-primary-overlay--dark: lighten($iui-color-background-primary--dark, 5%);
$iui-color-background-positive-overlay--dark: lighten($iui-color-background-positive--dark, 5%);
$iui-color-foreground-primary-overlay--dark: lighten($iui-color-foreground-primary--dark, 10%);
$iui-color-foreground-positive-overlay--dark: lighten($iui-color-foreground-positive--dark, 10%);
$iui-color-foreground-warning-overlay--dark: lighten($iui-color-foreground-warning--dark, 10%);
$iui-color-foreground-negative-overlay--dark: lighten($iui-color-foreground-negative--dark, 10%);

// Dark theme > Opacity stops
$iui-opacity-1--dark: 1;
$iui-opacity-2--dark: 0.85;
$iui-opacity-3--dark: 0.65;
$iui-opacity-4--dark: 0.45;
$iui-opacity-5--dark: 0.25;
$iui-opacity-6--dark: 0.1;

// Dark theme > Text colors
$iui-text-color--dark: rgba($iui-color-foreground-body--dark, $iui-opacity-2--dark);
$iui-text-color-muted--dark: rgba($iui-color-foreground-body--dark, $iui-opacity-4--dark);
$iui-text-color-placeholder--dark: rgba($iui-color-foreground-body--dark, $iui-opacity-5--dark);

// Dark theme > Focus color
$iui-focus-box-shadow--dark: rgba($iui-color-foreground-primary--dark, $iui-opacity-5--dark) 0 0 0 2px;
$iui-focus-positive-box-shadow--dark: rgba($iui-color-foreground-positive--dark, $iui-opacity-5--dark) 0 0 0 2px;
$iui-focus-warning-box-shadow--dark: rgba($iui-color-foreground-warning--dark, $iui-opacity-5--dark) 0 0 0 2px;
$iui-focus-negative-box-shadow--dark: rgba($iui-color-foreground-negative--dark, $iui-opacity-5--dark) 0 0 0 2px;
// Dark theme > Icon colors
$iui-icons-color--dark: rgba($iui-color-foreground-body--dark, $iui-opacity-4--dark);
$iui-icons-color-actionable--dark: rgba($iui-color-foreground-body--dark, $iui-opacity-2--dark);
$iui-icons-color-actionable-hover--dark: rgba($iui-color-foreground-body--dark, $iui-opacity-1--dark);
$iui-icons-color-actionable-disabled--dark: rgba($iui-color-foreground-body--dark, $iui-opacity-5--dark);
$iui-icons-color-primary--dark: $iui-color-foreground-primary--dark;
$iui-icons-color-positive--dark: $iui-color-foreground-positive--dark;
$iui-icons-color-negative--dark: $iui-color-foreground-negative--dark;
$iui-icons-color-warning--dark: $iui-color-foreground-warning--dark;

// Theme values
$themes: (
  light: (
    iui-color-background-1: $iui-color-background-1--light,
    iui-color-background-2: $iui-color-background-2--light,
    iui-color-background-3: $iui-color-background-3--light,
    iui-color-background-4: $iui-color-background-4--light,
    iui-color-background-5: $iui-color-background-5--light,
    iui-color-background-primary: $iui-color-background-primary--light,
    iui-color-background-positive: $iui-color-background-positive--light,
    iui-color-background-negative: $iui-color-background-negative--light,
    iui-color-background-warning: $iui-color-background-warning--light,
    iui-color-background-disabled: $iui-color-background-disabled--light,
    iui-color-foreground-body: $iui-color-foreground-body--light,
    iui-color-foreground-body-invert: $iui-color-foreground-body-invert--light,
    iui-color-foreground-accessory: $iui-color-foreground-accessory--light,
    iui-color-foreground-primary: $iui-color-foreground-primary--light,
    iui-color-foreground-positive: $iui-color-foreground-positive--light,
    iui-color-foreground-negative: $iui-color-foreground-negative--light,
    iui-color-foreground-warning: $iui-color-foreground-warning--light,
    iui-color-background-1-overlay: $iui-color-background-1-overlay--light,
    iui-color-background-primary-overlay: $iui-color-background-primary-overlay--light,
    iui-color-background-positive-overlay: $iui-color-background-positive-overlay--light,
    iui-color-foreground-primary-overlay: $iui-color-foreground-primary-overlay--light,
    iui-color-foreground-positive-overlay: $iui-color-foreground-positive-overlay--light,
    iui-color-foreground-warning-overlay: $iui-color-foreground-warning-overlay--light,
    iui-color-foreground-negative-overlay: $iui-color-foreground-negative-overlay--light,
    iui-opacity-1: $iui-opacity-1--light,
    iui-opacity-2: $iui-opacity-2--light,
    iui-opacity-3: $iui-opacity-3--light,
    iui-opacity-4: $iui-opacity-4--light,
    iui-opacity-5: $iui-opacity-5--light,
    iui-opacity-6: $iui-opacity-6--light,
    iui-text-color: $iui-text-color--light,
    iui-text-color-muted: $iui-text-color-muted--light,
    iui-text-color-placeholder: $iui-text-color-placeholder--light,
    iui-focus-box-shadow: $iui-focus-box-shadow--light,
    iui-focus-positive-box-shadow: $iui-focus-positive-box-shadow--light,
    iui-focus-warning-box-shadow: $iui-focus-warning-box-shadow--light,
    iui-focus-negative-box-shadow: $iui-focus-negative-box-shadow--light,
    iui-icons-color: $iui-icons-color--light,
    iui-icons-color-actionable: $iui-icons-color-actionable--light,
    iui-icons-color-actionable-hover: $iui-icons-color-actionable-hover--light,
    iui-icons-color-actionable-disabled: $iui-icons-color-actionable-disabled--light,
    iui-icons-color-primary: $iui-icons-color-primary--light,
    iui-icons-color-positive: $iui-icons-color-positive--light,
    iui-icons-color-negative: $iui-icons-color-negative--light,
    iui-icons-color-warning: $iui-icons-color-warning--light,
  ),
  dark: (
    iui-color-background-1: $iui-color-background-1--dark,
    iui-color-background-2: $iui-color-background-2--dark,
    iui-color-background-3: $iui-color-background-3--dark,
    iui-color-background-4: $iui-color-background-4--dark,
    iui-color-background-5: $iui-color-background-5--dark,
    iui-color-background-primary: $iui-color-background-primary--dark,
    iui-color-background-positive: $iui-color-background-positive--dark,
    iui-color-background-negative: $iui-color-background-negative--dark,
    iui-color-background-warning: $iui-color-background-warning--dark,
    iui-color-background-disabled: $iui-color-background-disabled--dark,
    iui-color-foreground-body: $iui-color-foreground-body--dark,
    iui-color-foreground-body-invert: $iui-color-foreground-body-invert--dark,
    iui-color-foreground-accessory: $iui-color-foreground-accessory--dark,
    iui-color-foreground-primary: $iui-color-foreground-primary--dark,
    iui-color-foreground-positive: $iui-color-foreground-positive--dark,
    iui-color-foreground-negative: $iui-color-foreground-negative--dark,
    iui-color-foreground-warning: $iui-color-foreground-warning--dark,
    iui-color-background-1-overlay: $iui-color-background-1-overlay--dark,
    iui-color-background-primary-overlay: $iui-color-background-primary-overlay--dark,
    iui-color-background-positive-overlay: $iui-color-background-positive-overlay--dark,
    iui-color-foreground-primary-overlay: $iui-color-foreground-primary-overlay--dark,
    iui-color-foreground-positive-overlay: $iui-color-foreground-positive-overlay--dark,
    iui-color-foreground-warning-overlay: $iui-color-foreground-warning-overlay--dark,
    iui-color-foreground-negative-overlay: $iui-color-foreground-negative-overlay--dark,
    iui-opacity-1: $iui-opacity-1--dark,
    iui-opacity-2: $iui-opacity-2--dark,
    iui-opacity-3: $iui-opacity-3--dark,
    iui-opacity-4: $iui-opacity-4--dark,
    iui-opacity-5: $iui-opacity-5--dark,
    iui-opacity-6: $iui-opacity-6--dark,
    iui-text-color: $iui-text-color--dark,
    iui-text-color-muted: $iui-text-color-muted--dark,
    iui-text-color-placeholder: $iui-text-color-placeholder--dark,
    iui-focus-box-shadow: $iui-focus-box-shadow--dark,
    iui-focus-positive-box-shadow: $iui-focus-positive-box-shadow--dark,
    iui-focus-warning-box-shadow: $iui-focus-warning-box-shadow--dark,
    iui-focus-negative-box-shadow: $iui-focus-negative-box-shadow--dark,
    iui-icons-color: $iui-icons-color--dark,
    iui-icons-color-actionable: $iui-icons-color-actionable--dark,
    iui-icons-color-actionable-hover: $iui-icons-color-actionable-hover--dark,
    iui-icons-color-actionable-disabled: $iui-icons-color-actionable-disabled--dark,
    iui-icons-color-primary: $iui-icons-color-primary--dark,
    iui-icons-color-positive: $iui-icons-color-positive--dark,
    iui-icons-color-negative: $iui-icons-color-negative--dark,
    iui-icons-color-warning: $iui-icons-color-warning--dark,
  ),
);

// Overrides of $themes used when creating CSS variables
$cssVariables: (
  iui-text-color: rgba(var(--iui-color-foreground-body-rgb), var(--iui-opacity-2)),
  iui-text-color-muted: rgba(var(--iui-color-foreground-body-rgb), var(--iui-opacity-4)),
  iui-text-color-placeholder: rgba(var(--iui-color-foreground-body-rgb), var(--iui-opacity-5)),
  iui-focus-box-shadow: rgba(var(--iui-color-foreground-primary-rgb), var(--iui-opacity-5)) 0 0 0 2px,
  iui-focus-positive-box-shadow: rgba(var(--iui-color-foreground-positive-rgb), var(--iui-opacity-5)) 0 0 0 2px,
  iui-focus-warning-box-shadow: rgba(var(--iui-color-foreground-warning-rgb), var(--iui-opacity-5)) 0 0 0 2px,
  iui-focus-negative-box-shadow: rgba(var(--iui-color-foreground-negative-rgb), var(--iui-opacity-5)) 0 0 0 2px,
  iui-icons-color-primary: var(--iui-color-foreground-primary),
  iui-icons-color-positive: var(--iui-color-foreground-positive),
  iui-icons-color-negative: var(--iui-color-foreground-negative),
  iui-icons-color-warning: var(--iui-color-foreground-warning),
  iui-icons-color: rgba(var(--iui-color-foreground-body-rgb), var(--iui-opacity-4)),
  iui-icons-color-actionable: rgba(var(--iui-color-foreground-body-rgb), var(--iui-opacity-2)),
  iui-icons-color-actionable-hover: rgba(var(--iui-color-foreground-body-rgb), var(--iui-opacity-1)),
  iui-icons-color-actionable-disabled: rgba(var(--iui-color-foreground-body-rgb), var(--iui-opacity-5)),
);

@function getfallbackvars() {
  $theme: map-get($themes, light);

  @each $var, $value in $theme {
    @if (type-of($value) == color) {
      $theme: map-merge($theme, (#{$var}-rgb: $value));
    }
  }

  @return $theme;
}

$fallbackvars: getfallbackvars();

@function hextorgb($hex) {
  @return red($hex), green($hex), blue($hex);
}

@mixin theme-variables($theme) {
  $variableList: map-get($themes, $theme);

  @each $key, $value in $variableList {
    @if (map-has-key($cssVariables, $key)) {
      $cssVarValue: map-get($cssVariables, $key);

      --#{$key}: #{$cssVarValue};
    } @else if (type-of($value) == color) {
      $rgbVal: hextorgb($value);

      --#{$key}-rgb: #{$rgbVal};
      --#{$key}: rgb(var(--#{$key}-rgb));
    } @else {
      --#{$key}: #{$value};
    }
  }
}

$fallback: null;

//  Adds a CSS variable with a fallback value.
//
//  Usage example:
//  @include themed {
//    color: rgba(t(iui-color-background-1-rgb), t(iui-opacity-4));
//    background-color: t(iui-color-background-2);
//  }
@mixin themed($property: null, $var: null) {
  $fallback: true !global;
  @content;
  $fallback: false !global;
  @content;
}

// Returns a CSS variable or a fallback value. Can only be used in a `themed` mixin content.
@function t($var) {
  @if ($fallback) {
    @return map-get($fallbackvars, $var);
  }

  @return var(--#{unquote($var)});
}
