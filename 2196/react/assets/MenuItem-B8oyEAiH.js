import{r as e,o as j,v as Q,w as X,x as Y,t as Z,y as _,z as $,A as ee,d as y,C as te,D as ne,E as oe,G as ae,B as re,c as le,H as se,J as ie,m as L,l as ue,p as ce,h as de}from"./index-CuyZiCR-.js";import{u as me}from"./focusable-DtP7ag6a.js";import{L as m}from"./ListItem-CH5yiLa5.js";const pe=p=>e.createElement(j,p,e.createElement("path",{d:"M6.003 4.807v6.4a.28.28 0 0 0 .443.24L9.9 8.27a.34.34 0 0 0 0-.48L6.446 4.566a.269.269 0 0 0-.443.24z"})),fe=e.forwardRef((p,R)=>{let{className:x,trigger:f,positionReference:c,portal:N=!0,popoverProps:g,children:v,...C}=p,n=Q(),s=X(),i=Y(),{interactions:h,visible:S,onVisibleChange:r,...b}=g??{},{listNavigation:l,hover:d,...P}=h??{},[M,u]=Z(!1,S,r),[w,E]=e.useState(!1),[k,V]=e.useState(null),{focusableElementsRef:A,focusableElements:D}=me(k,{filter:t=>t.filter(o=>!(t!=null&&t.some(I=>I.contains(o.parentElement))))}),[F,z]=e.useState(null),a=_({nodeId:s,visible:M,onVisibleChange:t=>t?u(!0):K(),interactions:{hover:n==null?d:{enabled:!!d&&!w,...d},...P},...b,middleware:{size:{maxHeight:"var(--iui-menu-max-height)"},...b.middleware}}),{getReferenceProps:O,getFloatingProps:T,getItemProps:q}=$([ee(a.context,{activeIndex:F,focusItemOnHover:!1,listRef:A,onNavigate:z,...l})]);e.useEffect(()=>{c!==void 0&&a.refs.setPositionReference(c)},[a.refs,c]);let J=y(V,R,a.refs.setFloating),B=e.useRef(null),K=e.useCallback(()=>{var t;u(!1),i==null&&((t=B.current)==null||t.focus({preventScroll:!0}))},[i,u]);te(e.useCallback(()=>{let t=o=>{(i===o.parentId&&s!==o.nodeId||i===o.nodeId)&&(u(!1),E(!1))};return n==null||n.events.on("onNodeFocused",t),()=>{n==null||n.events.off("onNodeFocused",t)}},[s,i,n==null?void 0:n.events,u]),()=>{},()=>{});let U=({focusableItemIndex:t,userProps:o})=>q({...o,tabIndex:F!=null&&F>=0&&t!=null&&t>=0&&F===t?0:-1,onFocus:L(o==null?void 0:o.onFocus,()=>{queueMicrotask(()=>{E(!0)}),n==null||n.events.emit("onNodeFocused",{nodeId:s,parentId:i})}),onMouseEnter:L(o==null?void 0:o.onMouseEnter,I=>{t!=null&&t>=0&&z(t),I.target===I.currentTarget&&I.currentTarget.focus()})}),W=ne(f,t=>O(a.getReferenceProps({...t.props,"aria-expanded":a.open,ref:oe(B,a.refs.setReference)}))),H=a.open&&e.createElement(ae,{portal:N},e.createElement(re,{as:"div",className:le("iui-menu",x),ref:J,...T(a.getFloatingProps({role:"menu",...C}))},v));return e.createElement(e.Fragment,null,e.createElement(G.Provider,{value:{popoverGetItemProps:U,focusableElements:D}},e.createElement(se.Provider,{value:a.open},W),n!=null?e.createElement(ie,{id:s},H):H))}),G=e.createContext(void 0),Ie=e.forwardRef((p,R)=>{let{children:x,isSelected:f,disabled:c,value:N,onClick:g,sublabel:v,size:C=v?"large":"default",icon:n,startIcon:s=n,badge:i,endIcon:h=i,role:S="menuitem",subMenuItems:r=[],...b}=p,l=e.useContext(G),d=e.useRef(null),P=ue(),M=e.useMemo(()=>({placement:"right-start",interactions:{click:!0,hover:!0,listNavigation:{nested:r.length>0,openOnArrowKeyDown:!0}}}),[r.length]),u=()=>g==null?void 0:g(N),w=l==null?void 0:l.focusableElements.findIndex(k=>k===d.current),E=e.createElement(ge,{actionable:!0,size:C,active:f,disabled:c,ref:y(d,R),role:S,tabIndex:f?0:-1,"aria-selected":f,"aria-haspopup":r.length>0?"true":void 0,"aria-controls":r.length>0?P:void 0,"aria-disabled":c,...(l==null?void 0:l.popoverGetItemProps)!=null?l.popoverGetItemProps({focusableItemIndex:w,userProps:{onClick:u}}):{onClick:u},...b},s&&e.createElement(m.Icon,{as:"span","aria-hidden":!0},s),e.createElement(m.Content,null,e.createElement("div",null,x),v&&e.createElement(m.Description,null,v)),!h&&r.length>0&&e.createElement(m.Icon,{as:"span","aria-hidden":!0},e.createElement(pe,null)),h&&e.createElement(m.Icon,{as:"span","aria-hidden":!0},h));return e.createElement(e.Fragment,null,r.length>0&&!c?e.createElement(fe,{id:P,trigger:E,popoverProps:M},r):E)});let ge=ce(de,m);export{Ie as M,fe as a};
