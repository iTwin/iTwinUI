import{p as se,r as e,g as D,V as ie,B as h,c as k,b as ue,d as F,m as H,l as ce,n as oe,y as de,G as me,L as fe,M as be}from"./index-CuyZiCR-.js";import{M as Ee}from"./MenuItem-B8oyEAiH.js";import{I as ve}from"./Icon-D3eQNw0n.js";import{L as ge}from"./List-iRiaQ3Ry.js";import{S as he}from"./SvgCheckmark-CqfAuPmP.js";import{S as Se}from"./SvgCaretDownSmall-BwHDBAqJ.js";const K=se.div("iui-input-with-icon"),ye=({text:t=""})=>{let[n,a]=e.useState(t);return e.useEffect(()=>{var s;a(t);let r=(s=D())==null?void 0:s.setTimeout(()=>a(""),5e3);return()=>{var o;return void((o=D())==null?void 0:o.clearTimeout(r))}},[t]),e.createElement(ie,{as:"div","aria-live":"polite","aria-atomic":"true"},n)},W=e.forwardRef((t,n)=>{let{className:a,label:r,...s}=t;return e.createElement(h,{as:"span",className:k("iui-select-tag",a),ref:n,...s},e.createElement(h,{as:"span",className:"iui-select-tag-label"},r))}),xe=e.forwardRef((t,n)=>{let{tags:a,className:r,...s}=t,[o,f]=ue(a),m=F(n,o);return e.createElement(h,{className:k("iui-select-tag-container",r),ref:m,...s},e.createElement(e.Fragment,null,f<a.length?a.slice(0,f-1):a,f<a.length&&e.createElement(W,{label:`+${a.length-f+1} item(s)`})))}),ze=e.forwardRef((t,n)=>{let{native:a,...r}=t,s=a?pe:Ce;return e.createElement(s,{...r,ref:n})});let pe=e.forwardRef((t,n)=>{let{triggerProps:a,options:r,disabled:s,placeholder:o,defaultValue:f=o!==void 0?"":void 0,value:m,onChange:S,size:y,status:N,styleType:d,required:v,...b}=t;return e.createElement(K,{...b,ref:n},e.createElement(j,{as:"select",size:y,status:N,styleType:d,disabled:s,defaultValue:m===void 0?f:void 0,value:m===null?"":m,required:v,...a,onKeyDown:H(a==null?void 0:a.onKeyDown,u=>{var T,c;u.key==="Enter"&&((c=(T=u.currentTarget).showPicker)==null||c.call(T))}),onChange:H(a==null?void 0:a.onChange,u=>{S==null||S(u.currentTarget.value,u)})},d!=="borderless"&&o!==void 0?e.createElement("option",{value:"",disabled:!0},o):null,r.map(u=>e.createElement("option",{key:u.value,...u},u.label))),e.createElement(G,{disabled:s}))}),Ce=e.forwardRef((t,n)=>{let a=ce(),{options:r,value:s,onChange:o,placeholder:f,disabled:m=!1,size:S,itemRenderer:y,selectedItemRenderer:N,menuClassName:d,menuStyle:v,multiple:b=!1,triggerProps:u,status:T,popoverProps:c,styleType:U,...J}=t,[O,z]=e.useState(!1),[Q,X]=e.useState(""),[Y,B]=e.useState(),i=s!==void 0?s:Y,g=oe(o),$=e.useRef(null),Z=e.useCallback(()=>{var l;m||(z(!0),(l=c==null?void 0:c.onVisibleChange)==null||l.call(c,!0))},[m,c]),V=e.useCallback(()=>{var l,E;z(!1),(l=$.current)==null||l.focus({preventScroll:!0}),(E=c==null?void 0:c.onVisibleChange)==null||E.call(c,!1)},[c]),_=e.useMemo(()=>r.map((l,E)=>{let p=M(i,b)?(i==null?void 0:i.includes(l.value))??!1:i===l.value,q=y?y(l,{close:()=>z(!1),isSelected:p}):e.createElement(Ee,null,l.label),{label:te,icon:ae,startIcon:le,...ne}=l,re=le??ae;return e.cloneElement(q,{key:`${te}-${E}`,isSelected:p,startIcon:re,endIcon:p?e.createElement(he,{"aria-hidden":!0}):null,onClick:()=>{var R,A;if(!l.disabled&&(Ne(g.current,b)?(B(l.value),(R=g.current)==null||R.call(g,l.value),V()):(B(C=>p?C==null?void 0:C.filter(L=>l.value!==L):[...C??[],l.value]),(A=g.current)==null||A.call(g,l.value,p?"removed":"added")),M(i,b))){let C=i||[],L=p?C.filter(I=>l.value!==I):[...C,l.value];X(r.filter(I=>L.includes(I.value)).map(I=>I.label).filter(Boolean).join(", "))}},ref:R=>{p&&!b&&(R==null||R.scrollIntoView({block:"nearest"}))},role:"option",...ne,...q.props})}),[V,y,b,g,r,i]),x=e.useMemo(()=>{if(i!=null)return M(i,b)?r.filter(l=>i.some(E=>E===l.value)):r.find(l=>l.value===i)},[b,r,i]),P=e.useMemo(()=>{let l=0;return Array.isArray(i)&&i.length>0?l=r.findIndex(E=>E.value===i[0]):i&&(l=r.findIndex(E=>E.value===i)),l>=0?l:0},[r,i]),ee=e.useCallback(l=>e.createElement(W,{key:l.label,label:l.label}),[]),w=de({visible:O,matchWidth:!0,closeOnOutsideClick:!0,middleware:{size:{maxHeight:"var(--iui-menu-max-height)"}},...c,onVisibleChange:l=>l?Z():V()});return e.createElement(e.Fragment,null,e.createElement(K,{...J,ref:F(w.refs.setPositionReference,n)},e.createElement(j,{...w.getReferenceProps(),tabIndex:0,role:"combobox",size:S,status:T,"aria-disabled":m?"true":void 0,"data-iui-disabled":m?"true":void 0,"aria-autocomplete":"none","aria-expanded":O,"aria-haspopup":"listbox","aria-controls":`${a}-menu`,styleType:U,...u,ref:F($,u==null?void 0:u.ref,w.refs.setReference),className:k({"iui-placeholder":(!x||x.length===0)&&!!f},u==null?void 0:u.className)},(!x||x.length===0)&&e.createElement(h,{as:"span",className:"iui-content"},f),M(x,b)?e.createElement(Re,{selectedItems:x,selectedItemsRenderer:N,tagRenderer:ee}):e.createElement(we,{selectedItem:x,selectedItemRenderer:N})),e.createElement(G,{disabled:m,isOpen:O}),b?e.createElement(ye,{text:Q}):null),w.open&&e.createElement(me,null,e.createElement(ke,{defaultFocusedIndex:P,className:d,id:`${a}-menu`,key:`${a}-menu`,...w.getFloatingProps({style:v,onKeyDown:({key:l})=>{l==="Tab"&&V()}}),ref:w.refs.setFloating},_)))}),M=(t,n)=>n,Ne=(t,n)=>!n,j=e.forwardRef((t,n)=>{let{size:a,status:r,styleType:s="default",...o}=t;return e.createElement(h,{"data-iui-size":a,"data-iui-status":r,"data-iui-variant":s!=="default"?s:void 0,...o,ref:n,className:k("iui-select-button","iui-field",t.className)})}),G=e.forwardRef((t,n)=>{let{disabled:a,isOpen:r,...s}=t;return e.createElement(ve,{"aria-hidden":!0,...s,ref:n,className:k("iui-end-icon",{"iui-disabled":a,"iui-open":r},t.className)},e.createElement(Se,null))}),we=({selectedItem:t,selectedItemRenderer:n})=>{let a=(t==null?void 0:t.startIcon)??(t==null?void 0:t.icon);return e.createElement(e.Fragment,null,t&&n&&n(t),t&&!n&&e.createElement(e.Fragment,null,a&&e.createElement(h,{as:"span",className:"iui-icon","aria-hidden":!0},a),e.createElement(h,{as:"span",className:"iui-content"},t.label)))},Re=({selectedItems:t,selectedItemsRenderer:n,tagRenderer:a})=>{let r=e.useMemo(()=>t?t.map(s=>a(s)):[],[t,a]);return e.createElement(e.Fragment,null,t&&n&&n(t),t&&!n&&e.createElement(h,{as:"span",className:"iui-content"},e.createElement(xe,{tags:r})))},ke=e.forwardRef((t,n)=>{let{defaultFocusedIndex:a=0,autoFocus:r=!0,children:s,className:o,...f}=t,[m,S]=e.useState(a),y=e.useCallback(d=>{queueMicrotask(()=>{let v=d==null?void 0:d.querySelector('[tabindex="0"]');v==null||v.focus()})},[]),N=e.useMemo(()=>e.Children.map(s,(d,v)=>e.isValidElement(d)?e.createElement(fe,{key:v,render:d,ref:d.props.ref||d.ref}):d),[s]);return e.createElement(be,{render:e.createElement(ge,{as:"div",className:k("iui-menu",o)}),orientation:"vertical",role:"listbox",activeIndex:m,onNavigate:S,ref:F(n,r?y:void 0),...f},N)});export{ye as A,K as I,ze as S,xe as a,W as b};
