import{r as t,b as ce,p as ie,e as be,f as le,K as me,I as Ne,c as w,B as j,m as O,j as x}from"./index-DFYM8etK.js";import{S as K}from"./Placeholder-B7thUiT_.js";import{a as H}from"./focusable-DV0zPFjk.js";import{u as fe}from"./useVirtualScroll-DUzy3nLF.js";import{S as xe}from"./SvgChevronRightSmall-9KcBCBZj.js";import{C as G}from"./Checkbox-C7yVhtB1.js";import{P as pe}from"./ProgressRadial-CHlDHkt_.js";const ae=t.createContext(void 0),Ee=()=>{let c=t.useContext(ae);if(c==null)throw new Error("TreeContext must be used within a TreeContext.Provider");return c},oe=t.createContext(void 0),L=c=>{let{data:m,className:d,nodeRenderer:u,getNode:f,size:b="default",enableVirtualization:a=!1,style:r,...i}=c,o=t.useRef(null),e=t.useRef(0);t.useEffect(()=>{e.current=0},[m]);let s=t.useCallback(()=>{let p=H(o.current);return p.filter(N=>!p.some(E=>E.contains(N.parentElement)))},[]),l=p=>{if(p.altKey)return;let N=s();if(!(N!=null&&N.length))return;let E=N.findIndex(S=>{var v;return S.contains((v=o.current)==null?void 0:v.ownerDocument.activeElement)}),h=E>-1?E:0;switch(p.key){case"ArrowUp":{p.preventDefault();let S=Math.max(0,h-1);N[S].focus(),e.current=S;break}case"ArrowDown":{p.preventDefault();let S=Math.min(N.length-1,h+1);N[S].focus(),e.current=S;break}}},[n,g]=t.useMemo(()=>{let p=[],N=[],E=(h=[],S=0,v)=>{let R=Array();return h.forEach((D,B)=>{let{subNodes:A,...U}=f(D),z={nodeProps:U,depth:S,parentNode:v,indexInGroup:B};if(R.push(z.nodeProps.nodeId),p.push(z),S===0&&N.push(z),z.nodeProps.isExpanded){let V=E(A,S+1,z);z.subNodeIds=V}}),R};return E(m),[p,N]},[m,f]),k=t.useCallback((p,N,E)=>{var S,v,R;let h=n[p];return t.createElement(ae.Provider,{key:h.nodeProps.nodeId,value:{nodeDepth:h.depth,subNodeIds:h.subNodeIds,groupSize:h.depth===0?g.length:((v=(S=h.parentNode)==null?void 0:S.subNodeIds)==null?void 0:v.length)??0,indexInGroup:h.indexInGroup,parentNodeId:(R=h.parentNode)==null?void 0:R.nodeProps.nodeId,scrollToParent:h.parentNode?()=>{var A;let D=(A=h.parentNode)==null?void 0:A.nodeProps.nodeId,B=n.findIndex(U=>U.nodeProps.nodeId===D);T(B)}:void 0,size:b}},N&&E?ce(u(h.nodeProps),D=>({...D.props,key:N.key,"data-iui-index":N.index,"data-iui-virtualizer":"item",ref:E.measureElement,style:{...D.props.style,"--_iui-width":"100%",transform:`translateY(${N.start}px)`}})):u(h.nodeProps))},[g.length,n,u,b]),[$,T]=t.useState(),M=t.useRef(n);t.useEffect(()=>{M.current=n},[n]),t.useEffect(()=>{setTimeout(()=>{var p;if($!==void 0){let N=M.current[$].nodeProps.nodeId,E=(p=o.current)==null?void 0:p.ownerDocument.querySelector(`#${N}`);E==null||E.focus(),T(void 0)}})},[$]);let _=p=>{var E,h;if((E=o.current)!=null&&E.contains(p.relatedTarget))return;let N=s();N.length>0&&((h=N[e.current])==null||h.focus())};return t.createElement(t.Fragment,null,a?t.createElement(ge,{flatNodesList:n,itemRenderer:k,scrollToIndex:$,onFocus:_,onKeyDown:l,ref:o,className:d,"data-iui-size":b==="small"?"small":void 0,style:r,...i}):t.createElement(ne,{onKeyDown:l,onFocus:_,className:d,"data-iui-size":b==="small"?"small":void 0,style:r,ref:o,...i},n.map((p,N)=>k(N))))};let ne=ie.div("iui-tree",{role:"tree",tabIndex:0}),ge=t.forwardRef(({flatNodesList:c,itemRenderer:m,scrollToIndex:d,...u},f)=>{let b=t.useRef(null),a=t.useRef(null),r=t.useCallback(s=>c[s].nodeProps.nodeId,[c]),i=t.useMemo(()=>he(s=>{if(!s||!a.current)return;a.current.style.width="";let l=0;s.elementsCache.forEach(n=>{n.clientWidth>l&&(l=n.clientWidth)}),l&&(a.current.style.width=`${l}px`)},100),[]),{virtualizer:o,css:e}=fe({count:c.length,getScrollElement:()=>b.current,estimateSize:()=>39,getItemKey:r,onChange:i});return be(()=>{d&&o.scrollToIndex(d)},[o,d]),t.createElement(ne,{...u,ref:le(f,b)},t.createElement("div",{style:{display:"contents"}},t.createElement(me,{css:e},t.createElement("div",{"data-iui-virtualizer":"root",style:{minBlockSize:o.getTotalSize()},ref:a},t.createElement("slot",null))),t.createElement(oe.Provider,{value:t.useMemo(()=>({virtualizer:o,onVirtualizerChange:i}),[o,i])},o.getVirtualItems().map(s=>m(s.index,s,o)))))});function he(c,m){let d;return(...u)=>{d&&window.clearTimeout(d),d=window.setTimeout(()=>{c(...u)},m)}}const re=t.forwardRef((c,m)=>{let{isExpanded:d,expanderIconProps:u={},...f}=c;return t.createElement(Ne,{styleType:"borderless",size:"small","aria-label":d?"Collapse":"Expand",ref:m,...f},t.createElement(xe,{...u,className:w("iui-tree-node-content-expander-icon",u==null?void 0:u.className,{"iui-tree-node-content-expander-icon-expanded":d})}))}),P=t.forwardRef((c,m)=>{let{nodeId:d,nodeProps:u={},label:f,labelProps:b={},sublabel:a,sublabelProps:r={},children:i,className:o,icon:e,iconProps:s={},hasSubNodes:l=!1,isDisabled:n=!1,isExpanded:g=!1,isSelected:k=!1,onSelected:$,onExpanded:T,checkbox:M,checkboxProps:_={},subTreeProps:p={},contentProps:N={},titleProps:E={},expanderProps:h={},expander:S,...v}=c,{nodeDepth:R,subNodeIds:D=[],parentNodeId:B,scrollToParent:A,groupSize:U,indexInGroup:z}=Ee(),{virtualizer:V,onVirtualizerChange:C}=t.useContext(oe)??{},[q,Y]=t.useState(!1),I=t.useRef(null),de=y=>{var Q,X,Z,ee,te,se;if(y.altKey)return;let J=I.current===((Q=I.current)==null?void 0:Q.ownerDocument.activeElement);switch(y.key){case"ArrowLeft":{if(y.preventDefault(),J){if(g){T(d,!1),C==null||C(V);break}B&&(A==null||A());break}let F=H(I.current),W=F.indexOf((X=I.current)==null?void 0:X.ownerDocument.activeElement);W===0?(Z=I.current)==null||Z.focus():(ee=F[W-1])==null||ee.focus();break}case"ArrowRight":{y.preventDefault();let F=H(I.current);if(J){if(!g&&l){T(d,!0),C==null||C(V);break}(te=F[0])==null||te.focus();break}let W=F.indexOf((se=I.current)==null?void 0:se.ownerDocument.activeElement);W<F.length-1&&F[W+1].focus();break}case" ":case"Spacebar":case"Enter":if(y.target!==I.current)break;y.preventDefault(),n||$==null||$(d,!k);break}},ue=t.useCallback(y=>{T(d,!g),C==null||C(V),y.stopPropagation()},[g,d,T,C,V]);return t.createElement(j,{as:"div",role:"treeitem",className:w("iui-tree-item",o),"aria-expanded":l?g:void 0,"aria-disabled":n,"aria-selected":k,"aria-level":R+1,"aria-setsize":U,"aria-posinset":z+1,tabIndex:-1,...v,id:d,ref:le(I,m),onFocus:O(c.onFocus,y=>{Y(!0),y.stopPropagation()}),onBlur:O(c.onBlur,()=>{Y(!1)}),onKeyDown:O(c.onKeyDown,de)},t.createElement(j,{as:"div",style:{"--level":R},onClick:()=>!n&&($==null?void 0:$(d,!k)),...u,className:w("iui-tree-node",{"iui-active":k,"iui-disabled":n},u==null?void 0:u.className)},M&&t.createElement(j,{as:"div",..._,className:w("iui-tree-node-checkbox",_==null?void 0:_.className)},t.isValidElement(M)?t.cloneElement(M,{tabIndex:q?0:-1}):M),t.createElement(j,{as:"div",...N,className:w("iui-tree-node-content",N==null?void 0:N.className)},l&&S,l&&!S&&t.createElement(re,{isExpanded:g,disabled:n,onClick:ue,tabIndex:q?0:-1,...h}),e&&t.createElement(j,{as:"span","aria-hidden":!0,...s,className:w("iui-tree-node-content-icon",s==null?void 0:s.className)},e),t.createElement(j,{as:"div",...b,className:w("iui-tree-node-content-label",b==null?void 0:b.className)},t.createElement(j,{as:"div",...E,className:w("iui-tree-node-content-title",E==null?void 0:E.className)},f),a&&t.createElement(j,{as:"div",...r,className:w("iui-tree-node-content-caption",r==null?void 0:r.className)},a)),i)),l&&t.createElement(j,{as:"div",role:"group","aria-owns":D.join(" "),...p,className:w("iui-sub-tree",p==null?void 0:p.className)}))}),Ie={title:"Tree"},je=()=>{const[c,m]=t.useState({"Node-2":!0,"Node-2-1":!0,"Node-3":!0}),d=t.useCallback((a,r)=>{r?(m(i=>({...i,[a]:!0})),console.log(`Expanded node ${a}`)):(m(i=>({...i,[a]:!1})),console.log(`Closed node ${a}`))},[]),u=t.useCallback((a,r="",i=0)=>{const o=r?`${r}-${a}`:`${a}`;return{id:`Node-${o}`,label:`Node ${o}`,sublabel:`Sublabel for Node ${o}`,subItems:i<10?Array(Math.round(a%5)).fill(null).map((e,s)=>u(s,o,i+1)):[]}},[]),f=t.useMemo(()=>Array(8).fill(null).map((a,r)=>u(r)),[u]),b=t.useCallback(a=>({subNodes:a.subItems,nodeId:a.id,node:a,isExpanded:c[a.id],hasSubNodes:a.subItems.length>0}),[c]);return x.jsx(L,{data:f,getNode:b,nodeRenderer:t.useCallback(({node:a,...r})=>x.jsx(P,{label:a.label,onExpanded:d,...r}),[d])})},Re=()=>{const[c,m]=t.useState({"Node-0":!0,"Node-3-2":!0,"Node-22":!0}),d=t.useCallback((e,s)=>{s?(m(l=>({...l,[e]:!0})),console.log(`Selected node ${e}`)):(m(l=>({...l,[e]:!1})),console.log(`Unselected node ${e}`))},[]),[u,f]=t.useState({"Node-2":!0,"Node-2-1":!0,"Node-3":!0}),b=t.useCallback((e,s)=>{s?(f(l=>({...l,[e]:!0})),console.log(`Expanded node ${e}`)):(f(l=>({...l,[e]:!1})),console.log(`Closed node ${e}`))},[]),[a]=t.useState({"Node-4":!0,"Node-3-0":!0,"Node-6":!0,"Node-10":!0}),r=t.useCallback((e,s="",l=0)=>{const n=s?`${s}-${e}`:`${e}`;return{id:`Node-${n}`,label:`Node ${n}`,sublabel:`Sublabel for Node ${n}`,subItems:l<10?Array(Math.round(e%5)).fill(null).map((g,k)=>r(k,n,l+1)):[]}},[]),i=t.useMemo(()=>Array(8).fill(null).map((e,s)=>r(s)),[r]),o=t.useCallback(e=>({subNodes:e.subItems,nodeId:e.id,node:e,isExpanded:u[e.id],isDisabled:a[e.id],isSelected:c[e.id],hasSubNodes:e.subItems.length>0}),[a,u,c]);return x.jsx(L,{data:i,getNode:o,nodeRenderer:t.useCallback(({node:e,...s})=>x.jsx(P,{label:e.label,sublabel:e.sublabel,onExpanded:b,onSelected:d,checkbox:x.jsx(G,{variant:"eyeball",disabled:s.isDisabled}),icon:x.jsx(K,{}),...s}),[b,d])})},De=()=>{const c=t.useCallback(e=>({id:`Node-${e}`,label:`Node ${e}`,subItems:[],hasSubNodes:!0}),[]),[m,d]=t.useState(()=>Array(8).fill(null).map((e,s)=>c(s))),[u,f]=t.useState({}),b=t.useCallback((e,s)=>{s?(f(l=>({...l,[e]:!0})),console.log(`Selected node ${e}`)):(f(l=>({...l,[e]:!1})),console.log(`Unselected node ${e}`))},[]),[a,r]=t.useState({}),i=t.useCallback((e,s,l)=>{s&&!l.subItems.length&&l.hasSubNodes&&setTimeout(()=>{d(n=>{const g=[...n],k=g.find($=>$.id===e);return k?(k.subItems=[{id:`Async-${e}`,label:`Async ${e}`,subItems:[]}],g):n})},1e3),s?(r(n=>({...n,[e]:!0})),console.log(`Expanded node ${e}`)):(r(n=>({...n,[e]:!1})),console.log(`Closed node ${e}`))},[]),o=t.useCallback(e=>({subNodes:!e.subItems.length&&e.hasSubNodes?[{id:`Async-${e.id}`,label:"",subItems:[],isLoading:!0}]:e.subItems,nodeId:e.id,node:e,isExpanded:a[e.id],isSelected:u[e.id],hasSubNodes:!!e.hasSubNodes}),[a,u]);return x.jsx(L,{data:m,getNode:o,nodeRenderer:t.useCallback(({node:e,...s})=>x.jsx(P,{label:e.isLoading?"Loading...":e.label,onExpanded:(l,n)=>i(l,n,e),onSelected:b,checkbox:x.jsx(G,{variant:"eyeball",disabled:s.isDisabled}),icon:e.isLoading?x.jsx(pe,{size:"x-small",indeterminate:!0}):x.jsx(K,{}),...s}),[i,b])})},Ae=()=>{const[c,m]=t.useState({"Node-0":!0,"Node-3-2":!0,"Node-22":!0}),d=t.useCallback((s,l)=>{l?(m(n=>({...n,[s]:!0})),console.log(`Selected node ${s}`)):(m(n=>({...n,[s]:!1})),console.log(`Unselected node ${s}`))},[]),[u,f]=t.useState({"Node-2":!0,"Node-2-1":!0,"Node-3":!0}),b=t.useCallback((s,l)=>{l?(f(n=>({...n,[s]:!0})),console.log(`Expanded node ${s}`)):(f(n=>({...n,[s]:!1})),console.log(`Closed node ${s}`))},[]),[a]=t.useState({"Node-4":!0,"Node-3":!0,"Node-6":!0,"Node-10":!0}),r=t.useCallback(s=>Object.keys(a).some(l=>s===l||s.startsWith(`${l}-`)),[a]),i=t.useCallback((s,l="",n=0)=>{const g=l?`${l}-${s}`:`${s}`;return{id:`Node-${g}`,label:`Node ${g}`,sublabel:`Sublabel for Node ${g}`,subItems:n<10?Array(Math.round(s%5)).fill(null).map((k,$)=>i($,g,n+1)):[]}},[]),o=t.useMemo(()=>Array(8).fill(null).map((s,l)=>i(l)),[i]),e=t.useCallback(s=>({subNodes:s.subItems,nodeId:s.id,node:s,isExpanded:u[s.id],isDisabled:r(s.id),isSelected:c[s.id],hasSubNodes:s.subItems.length>0}),[u,r,c]);return x.jsx(L,{data:o,getNode:e,nodeRenderer:t.useCallback(({node:s,...l})=>x.jsx(P,{label:s.label,sublabel:s.sublabel,onExpanded:b,onSelected:d,checkbox:x.jsx(G,{variant:"eyeball",disabled:l.isDisabled}),icon:x.jsx(K,{}),expander:x.jsx(re,{isExpanded:l.isExpanded,onClick:n=>{b(s.id,!l.isExpanded),n.stopPropagation()}}),...l}),[b,d])})},ze=()=>{const[c,m]=t.useState({"Node-0":!0,"Node-3-2":!0,"Node-22":!0}),d=t.useCallback((e,s)=>{s?(m(l=>({...l,[e]:!0})),console.log(`Selected node ${e}`)):(m(l=>({...l,[e]:!1})),console.log(`Unselected node ${e}`))},[]),[u,f]=t.useState({"Node-2":!0,"Node-2-1":!0,"Node-3":!0}),b=t.useCallback((e,s)=>{s?(f(l=>({...l,[e]:!0})),console.log(`Expanded node ${e}`)):(f(l=>({...l,[e]:!1})),console.log(`Closed node ${e}`))},[]),[a]=t.useState({"Node-4":!0,"Node-3-0":!0,"Node-6":!0,"Node-10":!0}),r=t.useCallback((e,s="",l=0)=>{const n=s?`${s}-${e}`:`${e}`;return{id:`Node-${n}`,label:`Node ${n}`,sublabel:`Sublabel for Node ${n}`,subItems:l<10?Array(Math.round(e%5)).fill(null).map((g,k)=>r(k,n,l+1)):[]}},[]),i=t.useMemo(()=>Array(1e5).fill(null).map((e,s)=>r(s)),[r]),o=t.useCallback(e=>({subNodes:e.subItems,nodeId:e.id,node:e,isExpanded:u[e.id],isDisabled:a[e.id],isSelected:c[e.id],hasSubNodes:e.subItems.length>0}),[a,u,c]);return x.jsx(L,{data:i,getNode:o,enableVirtualization:!0,nodeRenderer:t.useCallback(({node:e,...s})=>x.jsx(P,{label:e.label,sublabel:e.sublabel,onExpanded:b,onSelected:d,checkbox:x.jsx(G,{variant:"eyeball",disabled:s.isDisabled}),icon:x.jsx(K,{}),...s}),[b,d]),style:{height:"min(400px, 90vh)"}})},Te=()=>{const[c,m]=t.useState({"Node-2":!0,"Node-2-1":!0,"Node-3":!0}),d=t.useCallback((a,r)=>{r?(m(i=>({...i,[a]:!0})),console.log(`Expanded node ${a}`)):(m(i=>({...i,[a]:!1})),console.log(`Closed node ${a}`))},[]),u=t.useCallback((a,r="",i=0)=>{const o=r?`${r}-${a}`:`${a}`;return{id:`Node-${o}`,label:`Node ${o}`,sublabel:`Sublabel for Node ${o}`,subItems:i<10?Array(Math.round(a%5)).fill(null).map((e,s)=>u(s,o,i+1)):[]}},[]),f=t.useMemo(()=>Array(8).fill(null).map((a,r)=>u(r)),[u]),b=t.useCallback(a=>({subNodes:a.subItems,nodeId:a.id,node:a,isExpanded:c[a.id],hasSubNodes:a.subItems.length>0}),[c]);return x.jsx(L,{data:f,size:"small",getNode:b,nodeRenderer:t.useCallback(({node:a,...r})=>x.jsx(P,{label:a.label,sublabel:a.sublabel,onExpanded:d,icon:x.jsx(K,{}),...r}),[d])})},Me=()=>{const[c,m]=t.useState({"Node-0":!0,"Node-3-2":!0,"Node-22":!0}),d=t.useCallback((o,e)=>{e?(m(s=>({...s,[o]:!0})),console.log(`Selected node ${o}`)):(m(s=>({...s,[o]:!1})),console.log(`Unselected node ${o}`))},[]),[u,f]=t.useState({"Node-0":!0,"Node-0-0":!0,"Node-0-0-0":!0,"Node-0-0-0-0":!0,"Node-2":!0,"Node-2-1":!0,"Node-3":!0}),b=t.useCallback((o,e)=>{e?(f(s=>({...s,[o]:!0})),console.log(`Expanded node ${o}`)):(f(s=>({...s,[o]:!1})),console.log(`Closed node ${o}`))},[]),a=t.useCallback((o,e="",s=0)=>{const l=e?`${e}-${o}`:`${o}`;return{id:`Node-${l}`,label:`Node ${l}`,subItems:s<10?Array(1).fill(null).map((n,g)=>a(g,l,s+1)):[]}},[]),r=t.useMemo(()=>Array(1e5).fill(null).map((o,e)=>a(e)),[a]),i=t.useCallback(o=>({subNodes:o.subItems,nodeId:o.id,node:o,isExpanded:u[o.id],isSelected:c[o.id],hasSubNodes:o.subItems.length>0}),[u,c]);return x.jsx(L,{data:r,getNode:i,enableVirtualization:!0,nodeRenderer:t.useCallback(({node:o,...e})=>x.jsx(P,{label:o.label,onExpanded:b,onSelected:d,checkbox:x.jsx(G,{variant:"eyeball",disabled:e.isDisabled}),icon:x.jsx(K,{}),...e}),[b,d]),style:{height:"min(400px, 90vh)",width:"250px"}})};typeof window<"u"&&window.document&&window.document.createElement&&document.documentElement.setAttribute("data-storyloaded","");export{De as AsyncLoading,je as Basic,Ae as CustomizedExpander,Re as Full,Te as Small,ze as Virtualized,Me as VirtualizedWithHorizontalScroll,Ie as default};
